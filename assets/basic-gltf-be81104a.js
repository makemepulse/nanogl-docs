import{C as B,P as C}from"./index-099e42fb.js";import{G as F,a as M}from"./indexbuffer-5b89fc58.js";import{_ as A}from"./web-4702fa01.js";import{L as P,I as S}from"./Ibl-f425c70a.js";import{iblSh as T,iblPath as z}from"./iblData-2ac082dd.js";import{T as G}from"./texture-2d-53b1df66.js";import{c as L}from"./vec3-33249e24.js";import"./arraybuffer-7f1df196.js";import"./ShaderVersion-8538814c.js";import"./Bounds-f9785a14.js";import"./common-a066d304.js";const N=b=>{let d=!1;const r=b||document.getElementById("canvas"),e=r.getContext("webgl"),o={width:1,height:1},p=window.devicePixelRatio,v=([a])=>{const n=a.contentRect.width,x=a.contentRect.height;r.width=Math.round(n*p),r.height=Math.round(x*p),o.width=e.drawingBufferWidth,o.height=e.drawingBufferHeight},f=new ResizeObserver(v);f.observe(r);const i=F.get(e),R=new M().enableDepthTest().enableCullface().cullFace(e.BACK);i.push(R);const g=L(),t=new B(new C);t.lens.setAutoFov(35*(Math.PI/180)),t.lens.near=.01,t.lens.far=50,t.position.set([0,4,10]),t.lookAt(g);const s=new P;s.bounds.fromMinMax([-1,-1,-1],[1,1,1]);const m=new G(e,e.RGBA);m.clamp();const l=new S(m,T);l.iblFormat="OCTA",l.shFormat="SH9",l.hdrEncoding="RGBM";const h=new Image;h.src=z,h.onload=()=>{m.fromImage(h)},s.add(l);let c=null;A.loadGltf("/models/suzanne/Suzanne.gltf").then(async a=>{c=a,await c.allocate(e);for(const n of c.materials)n.materialPass.setLightSetup(s);d=!0,u()});const I=a=>{t.x=Math.sin(a*5e-4)*10,t.z=Math.cos(a*5e-4)*10,t.lookAt(g),t.invalidate()};let w=null;const u=(a=0)=>{if(d){e.viewport(0,0,o.width,o.height),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),i.apply(),I(a),t.updateWorldMatrix(),t.updateViewProjectionMatrix(o.width,o.height),s.prepare(e);for(const n of c.renderables)n.render(e,t,1,"color");w=window.requestAnimationFrame(u)}};return()=>{d=!1,window.cancelAnimationFrame(w),f.disconnect(),i.pop(),i.apply()}};export{N as preview};
