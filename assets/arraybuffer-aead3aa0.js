function N1(n){return n.fenceSync!==void 0}let z1=0;class w1{constructor(r,e,i,s){this.gl=r,this.program=r.createProgram(),this.vShader=r.createShader(r.VERTEX_SHADER),this.fShader=r.createShader(r.FRAGMENT_SHADER),this.dyns=[],this.ready=!1,r.attachShader(this.program,this.vShader),r.attachShader(this.program,this.fShader),this._uid=z1++|0,this._cuid=z1++|0,e!==void 0&&i!==void 0&&this.compile(e,i,s)}use(){this.ready||this._grabParameters(),this.gl.useProgram(this.program)}bind(){this.use()}compile(r,e,i){this.ready=!1,i=i===void 0?"":i+`
`;const s=this.gl;if(!(P1(s,this.fShader,i+e)&&P1(s,this.vShader,i+r)))return!1;if(s.linkProgram(this.program),!s.getProgramParameter(this.program,s.LINK_STATUS))return w1.debug&&A1(s.getProgramInfoLog(this.program)),!1;for(;this.dyns.length>0;)delete this[this.dyns.pop()];return this._cuid=z1++|0,!0}dispose(){this.gl!==null&&(this.gl.deleteProgram(this.program),this.gl.deleteShader(this.fShader),this.gl.deleteShader(this.vShader))}_grabParameters(){const r=this.gl,e=this.program,i={texIndex:0,ublockIndex:0},s=r.getProgramParameter(e,r.ACTIVE_UNIFORMS);for(var c=0;c<s;++c){var f=r.getActiveUniform(e,c);if(f===null){r.getError();continue}var h=f.name,a=h.indexOf("[");a>=0&&(h=h.substring(0,a));var t=r.getUniformLocation(e,f.name);t!==null&&(this[h]=Z1(f.type,t,r,i),this.dyns.push(h))}const l=r.getProgramParameter(e,r.ACTIVE_ATTRIBUTES);for(var d=0;d<l;++d){var v=r.getActiveAttrib(e,d).name,M=r.getAttribLocation(e,v);this[v]=J1(M),this.dyns.push(v)}if(N1(r)){const x=r.getProgramParameter(e,r.ACTIVE_UNIFORM_BLOCKS);for(var y=0;y<x;++y){var p=r.getActiveUniformBlockName(e,y);this[p]=K1(y,r,i),this.dyns.push(p)}}this.ready=!0}}w1.debug=!1;function A1(n){console.warn(n)}const W1=["","   ","  "," ",""];function j1(n,r){return W1[String(r+1).length]+(r+1)+": "+n}function U1(n){return n.split(`
`).map(j1).join(`
`)}const C1=/^ERROR:\s?(\d+):(\d+)/;function X1(n,r){const e=r.split(`
`);n=n.split(`
`).map(i=>{const s=C1.exec(i);return s&&(i+=`
  > `+e[parseInt(s[2])-1]),i}).join(`
`),r=U1(r),A1(n),A1(r)}function P1(n,r,e){return n.shaderSource(r,e),n.compileShader(r),n.getShaderParameter(r,n.COMPILE_STATUS)?!0:(w1.debug&&X1(n.getShaderInfoLog(r),e),!1)}const X={};X[String(5126)]="1f";X[String(35664)]="2f";X[String(35665)]="3f";X[String(35666)]="4f";X[String(35670)]=X[String(5124)]=X[String(35678)]=X[String(35680)]=X[String(35866)]="1i";X[String(35671)]=X[String(35667)]="2i";X[String(35672)]=X[String(35668)]="3i";X[String(35673)]=X[String(35669)]="4i";X[String(35674)]="Matrix2f";X[String(35675)]="Matrix3f";X[String(35676)]="Matrix4f";function Y1(n){return"uniform"+X[String(n)]}function Z1(n,r,e,i){switch(n){case e.FLOAT_MAT2:case e.FLOAT_MAT3:case e.FLOAT_MAT4:return G1(n,r,e);case e.SAMPLER_2D:case e.SAMPLER_CUBE:case 35682:case 35679:case 36289:return H1(n,r,e,i);default:return Q1(n,r,e)}}function Q1(n,r,e,i){const s=Y1(n);return function(...c){return c.length===1&&c[0].length!=null?e[s+"v"](r,c[0]):c.length>0&&e[s](r,...c),r}}function G1(n,r,e,i){const s=Y1(n);return function(){if(arguments.length>0&&arguments[0].length!==void 0){var c=arguments.length>1?!!arguments[1]:!1;e[s+"v"](r,c,arguments[0])}return r}}function H1(n,r,e,i){const s=i.texIndex++;return function(){return arguments.length===1&&(arguments[0].bind!==void 0?(arguments[0].bind(s),e.uniform1i(r,s)):e.uniform1i(r,arguments[0])),r}}function K1(n,r,e){const i=e.ublockIndex++;return function(){return arguments.length===1&&(arguments[0]instanceof WebGLBuffer?(r.uniformBlockBinding(this.program,n,i),r.bindBufferBase(r.UNIFORM_BUFFER,i,arguments[0])):r.uniformBlockBinding(this.program,n,arguments[0])),n}}function J1(n){return function(){return n}}var v1={};v1.EPSILON=1e-6;v1.ARRAY_TYPE=typeof Float32Array<"u"?Float32Array:Array;v1.RANDOM=Math.random;v1.setMatrixArrayType=function(n){GLMAT_ARRAY_TYPE=n};var k1=Math.PI/180;v1.toRadian=function(n){return n*k1};var i1=v1,E1=i1,Z={};Z.create=function(){var n=new E1.ARRAY_TYPE(4);return n[0]=1,n[1]=0,n[2]=0,n[3]=1,n};Z.clone=function(n){var r=new E1.ARRAY_TYPE(4);return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r};Z.copy=function(n,r){return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n};Z.identity=function(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=1,n};Z.transpose=function(n,r){if(n===r){var e=r[1];n[1]=r[2],n[2]=e}else n[0]=r[0],n[1]=r[2],n[2]=r[1],n[3]=r[3];return n};Z.invert=function(n,r){var e=r[0],i=r[1],s=r[2],c=r[3],f=e*c-s*i;return f?(f=1/f,n[0]=c*f,n[1]=-i*f,n[2]=-s*f,n[3]=e*f,n):null};Z.adjoint=function(n,r){var e=r[0];return n[0]=r[3],n[1]=-r[1],n[2]=-r[2],n[3]=e,n};Z.determinant=function(n){return n[0]*n[3]-n[2]*n[1]};Z.multiply=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3],h=e[0],a=e[1],t=e[2],l=e[3];return n[0]=i*h+c*a,n[1]=s*h+f*a,n[2]=i*t+c*l,n[3]=s*t+f*l,n};Z.mul=Z.multiply;Z.rotate=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3],h=Math.sin(e),a=Math.cos(e);return n[0]=i*a+c*h,n[1]=s*a+f*h,n[2]=i*-h+c*a,n[3]=s*-h+f*a,n};Z.scale=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3],h=e[0],a=e[1];return n[0]=i*h,n[1]=s*h,n[2]=c*a,n[3]=f*a,n};Z.fromRotation=function(n,r){var e=Math.sin(r),i=Math.cos(r);return n[0]=i,n[1]=e,n[2]=-e,n[3]=i,n};Z.fromScaling=function(n,r){return n[0]=r[0],n[1]=0,n[2]=0,n[3]=r[1],n};Z.str=function(n){return"mat2("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+")"};Z.frob=function(n){return Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2)+Math.pow(n[2],2)+Math.pow(n[3],2))};Z.LDU=function(n,r,e,i){return n[2]=i[2]/i[0],e[0]=i[0],e[1]=i[1],e[3]=i[3]-n[2]*e[1],[n,r,e]};var q1=i1,G={};G.create=function(){var n=new q1.ARRAY_TYPE(6);return n[0]=1,n[1]=0,n[2]=0,n[3]=1,n[4]=0,n[5]=0,n};G.clone=function(n){var r=new q1.ARRAY_TYPE(6);return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r};G.copy=function(n,r){return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n};G.identity=function(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=1,n[4]=0,n[5]=0,n};G.invert=function(n,r){var e=r[0],i=r[1],s=r[2],c=r[3],f=r[4],h=r[5],a=e*c-i*s;return a?(a=1/a,n[0]=c*a,n[1]=-i*a,n[2]=-s*a,n[3]=e*a,n[4]=(s*h-c*f)*a,n[5]=(i*f-e*h)*a,n):null};G.determinant=function(n){return n[0]*n[3]-n[1]*n[2]};G.multiply=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3],h=r[4],a=r[5],t=e[0],l=e[1],d=e[2],v=e[3],M=e[4],y=e[5];return n[0]=i*t+c*l,n[1]=s*t+f*l,n[2]=i*d+c*v,n[3]=s*d+f*v,n[4]=i*M+c*y+h,n[5]=s*M+f*y+a,n};G.mul=G.multiply;G.rotate=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3],h=r[4],a=r[5],t=Math.sin(e),l=Math.cos(e);return n[0]=i*l+c*t,n[1]=s*l+f*t,n[2]=i*-t+c*l,n[3]=s*-t+f*l,n[4]=h,n[5]=a,n};G.scale=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3],h=r[4],a=r[5],t=e[0],l=e[1];return n[0]=i*t,n[1]=s*t,n[2]=c*l,n[3]=f*l,n[4]=h,n[5]=a,n};G.translate=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3],h=r[4],a=r[5],t=e[0],l=e[1];return n[0]=i,n[1]=s,n[2]=c,n[3]=f,n[4]=i*t+c*l+h,n[5]=s*t+f*l+a,n};G.fromRotation=function(n,r){var e=Math.sin(r),i=Math.cos(r);return n[0]=i,n[1]=e,n[2]=-e,n[3]=i,n[4]=0,n[5]=0,n};G.fromScaling=function(n,r){return n[0]=r[0],n[1]=0,n[2]=0,n[3]=r[1],n[4]=0,n[5]=0,n};G.fromTranslation=function(n,r){return n[0]=1,n[1]=0,n[2]=0,n[3]=1,n[4]=r[0],n[5]=r[1],n};G.str=function(n){return"mat2d("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+")"};G.frob=function(n){return Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2)+Math.pow(n[2],2)+Math.pow(n[3],2)+Math.pow(n[4],2)+Math.pow(n[5],2)+1)};var L1=i1,U={};U.create=function(){var n=new L1.ARRAY_TYPE(9);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=1,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n};U.fromMat4=function(n,r){return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[4],n[4]=r[5],n[5]=r[6],n[6]=r[8],n[7]=r[9],n[8]=r[10],n};U.clone=function(n){var r=new L1.ARRAY_TYPE(9);return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],r};U.copy=function(n,r){return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n};U.identity=function(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=1,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n};U.transpose=function(n,r){if(n===r){var e=r[1],i=r[2],s=r[5];n[1]=r[3],n[2]=r[6],n[3]=e,n[5]=r[7],n[6]=i,n[7]=s}else n[0]=r[0],n[1]=r[3],n[2]=r[6],n[3]=r[1],n[4]=r[4],n[5]=r[7],n[6]=r[2],n[7]=r[5],n[8]=r[8];return n};U.invert=function(n,r){var e=r[0],i=r[1],s=r[2],c=r[3],f=r[4],h=r[5],a=r[6],t=r[7],l=r[8],d=l*f-h*t,v=-l*c+h*a,M=t*c-f*a,y=e*d+i*v+s*M;return y?(y=1/y,n[0]=d*y,n[1]=(-l*i+s*t)*y,n[2]=(h*i-s*f)*y,n[3]=v*y,n[4]=(l*e-s*a)*y,n[5]=(-h*e+s*c)*y,n[6]=M*y,n[7]=(-t*e+i*a)*y,n[8]=(f*e-i*c)*y,n):null};U.adjoint=function(n,r){var e=r[0],i=r[1],s=r[2],c=r[3],f=r[4],h=r[5],a=r[6],t=r[7],l=r[8];return n[0]=f*l-h*t,n[1]=s*t-i*l,n[2]=i*h-s*f,n[3]=h*a-c*l,n[4]=e*l-s*a,n[5]=s*c-e*h,n[6]=c*t-f*a,n[7]=i*a-e*t,n[8]=e*f-i*c,n};U.determinant=function(n){var r=n[0],e=n[1],i=n[2],s=n[3],c=n[4],f=n[5],h=n[6],a=n[7],t=n[8];return r*(t*c-f*a)+e*(-t*s+f*h)+i*(a*s-c*h)};U.multiply=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3],h=r[4],a=r[5],t=r[6],l=r[7],d=r[8],v=e[0],M=e[1],y=e[2],p=e[3],x=e[4],w=e[5],R=e[6],g=e[7],_=e[8];return n[0]=v*i+M*f+y*t,n[1]=v*s+M*h+y*l,n[2]=v*c+M*a+y*d,n[3]=p*i+x*f+w*t,n[4]=p*s+x*h+w*l,n[5]=p*c+x*a+w*d,n[6]=R*i+g*f+_*t,n[7]=R*s+g*h+_*l,n[8]=R*c+g*a+_*d,n};U.mul=U.multiply;U.translate=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3],h=r[4],a=r[5],t=r[6],l=r[7],d=r[8],v=e[0],M=e[1];return n[0]=i,n[1]=s,n[2]=c,n[3]=f,n[4]=h,n[5]=a,n[6]=v*i+M*f+t,n[7]=v*s+M*h+l,n[8]=v*c+M*a+d,n};U.rotate=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3],h=r[4],a=r[5],t=r[6],l=r[7],d=r[8],v=Math.sin(e),M=Math.cos(e);return n[0]=M*i+v*f,n[1]=M*s+v*h,n[2]=M*c+v*a,n[3]=M*f-v*i,n[4]=M*h-v*s,n[5]=M*a-v*c,n[6]=t,n[7]=l,n[8]=d,n};U.scale=function(n,r,e){var i=e[0],s=e[1];return n[0]=i*r[0],n[1]=i*r[1],n[2]=i*r[2],n[3]=s*r[3],n[4]=s*r[4],n[5]=s*r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n};U.fromTranslation=function(n,r){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=1,n[5]=0,n[6]=r[0],n[7]=r[1],n[8]=1,n};U.fromRotation=function(n,r){var e=Math.sin(r),i=Math.cos(r);return n[0]=i,n[1]=e,n[2]=0,n[3]=-e,n[4]=i,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n};U.fromScaling=function(n,r){return n[0]=r[0],n[1]=0,n[2]=0,n[3]=0,n[4]=r[1],n[5]=0,n[6]=0,n[7]=0,n[8]=1,n};U.fromMat2d=function(n,r){return n[0]=r[0],n[1]=r[1],n[2]=0,n[3]=r[2],n[4]=r[3],n[5]=0,n[6]=r[4],n[7]=r[5],n[8]=1,n};U.fromQuat=function(n,r){var e=r[0],i=r[1],s=r[2],c=r[3],f=e+e,h=i+i,a=s+s,t=e*f,l=i*f,d=i*h,v=s*f,M=s*h,y=s*a,p=c*f,x=c*h,w=c*a;return n[0]=1-d-y,n[3]=l-w,n[6]=v+x,n[1]=l+w,n[4]=1-t-y,n[7]=M-p,n[2]=v-x,n[5]=M+p,n[8]=1-t-d,n};U.normalFromMat4=function(n,r){var e=r[0],i=r[1],s=r[2],c=r[3],f=r[4],h=r[5],a=r[6],t=r[7],l=r[8],d=r[9],v=r[10],M=r[11],y=r[12],p=r[13],x=r[14],w=r[15],R=e*h-i*f,g=e*a-s*f,_=e*t-c*f,z=i*a-s*h,m=i*t-c*h,I=s*t-c*a,Y=l*p-d*y,E=l*x-v*y,S=l*w-M*y,W=d*x-v*p,F=d*w-M*p,j=v*w-M*x,A=R*j-g*F+_*W+z*S-m*E+I*Y;return A?(A=1/A,n[0]=(h*j-a*F+t*W)*A,n[1]=(a*S-f*j-t*E)*A,n[2]=(f*F-h*S+t*Y)*A,n[3]=(s*F-i*j-c*W)*A,n[4]=(e*j-s*S+c*E)*A,n[5]=(i*S-e*F-c*Y)*A,n[6]=(p*I-x*m+w*z)*A,n[7]=(x*_-y*I-w*g)*A,n[8]=(y*m-p*_+w*R)*A,n):null};U.str=function(n){return"mat3("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+", "+n[6]+", "+n[7]+", "+n[8]+")"};U.frob=function(n){return Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2)+Math.pow(n[2],2)+Math.pow(n[3],2)+Math.pow(n[4],2)+Math.pow(n[5],2)+Math.pow(n[6],2)+Math.pow(n[7],2)+Math.pow(n[8],2))};var b1=U,h1=i1,B={};B.create=function(){var n=new h1.ARRAY_TYPE(16);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n};B.clone=function(n){var r=new h1.ARRAY_TYPE(16);return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15],r};B.copy=function(n,r){return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],n};B.identity=function(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n};B.transpose=function(n,r){if(n===r){var e=r[1],i=r[2],s=r[3],c=r[6],f=r[7],h=r[11];n[1]=r[4],n[2]=r[8],n[3]=r[12],n[4]=e,n[6]=r[9],n[7]=r[13],n[8]=i,n[9]=c,n[11]=r[14],n[12]=s,n[13]=f,n[14]=h}else n[0]=r[0],n[1]=r[4],n[2]=r[8],n[3]=r[12],n[4]=r[1],n[5]=r[5],n[6]=r[9],n[7]=r[13],n[8]=r[2],n[9]=r[6],n[10]=r[10],n[11]=r[14],n[12]=r[3],n[13]=r[7],n[14]=r[11],n[15]=r[15];return n};B.invert=function(n,r){var e=r[0],i=r[1],s=r[2],c=r[3],f=r[4],h=r[5],a=r[6],t=r[7],l=r[8],d=r[9],v=r[10],M=r[11],y=r[12],p=r[13],x=r[14],w=r[15],R=e*h-i*f,g=e*a-s*f,_=e*t-c*f,z=i*a-s*h,m=i*t-c*h,I=s*t-c*a,Y=l*p-d*y,E=l*x-v*y,S=l*w-M*y,W=d*x-v*p,F=d*w-M*p,j=v*w-M*x,A=R*j-g*F+_*W+z*S-m*E+I*Y;return A?(A=1/A,n[0]=(h*j-a*F+t*W)*A,n[1]=(s*F-i*j-c*W)*A,n[2]=(p*I-x*m+w*z)*A,n[3]=(v*m-d*I-M*z)*A,n[4]=(a*S-f*j-t*E)*A,n[5]=(e*j-s*S+c*E)*A,n[6]=(x*_-y*I-w*g)*A,n[7]=(l*I-v*_+M*g)*A,n[8]=(f*F-h*S+t*Y)*A,n[9]=(i*S-e*F-c*Y)*A,n[10]=(y*m-p*_+w*R)*A,n[11]=(d*_-l*m-M*R)*A,n[12]=(h*E-f*W-a*Y)*A,n[13]=(e*W-i*E+s*Y)*A,n[14]=(p*g-y*z-x*R)*A,n[15]=(l*z-d*g+v*R)*A,n):null};B.adjoint=function(n,r){var e=r[0],i=r[1],s=r[2],c=r[3],f=r[4],h=r[5],a=r[6],t=r[7],l=r[8],d=r[9],v=r[10],M=r[11],y=r[12],p=r[13],x=r[14],w=r[15];return n[0]=h*(v*w-M*x)-d*(a*w-t*x)+p*(a*M-t*v),n[1]=-(i*(v*w-M*x)-d*(s*w-c*x)+p*(s*M-c*v)),n[2]=i*(a*w-t*x)-h*(s*w-c*x)+p*(s*t-c*a),n[3]=-(i*(a*M-t*v)-h*(s*M-c*v)+d*(s*t-c*a)),n[4]=-(f*(v*w-M*x)-l*(a*w-t*x)+y*(a*M-t*v)),n[5]=e*(v*w-M*x)-l*(s*w-c*x)+y*(s*M-c*v),n[6]=-(e*(a*w-t*x)-f*(s*w-c*x)+y*(s*t-c*a)),n[7]=e*(a*M-t*v)-f*(s*M-c*v)+l*(s*t-c*a),n[8]=f*(d*w-M*p)-l*(h*w-t*p)+y*(h*M-t*d),n[9]=-(e*(d*w-M*p)-l*(i*w-c*p)+y*(i*M-c*d)),n[10]=e*(h*w-t*p)-f*(i*w-c*p)+y*(i*t-c*h),n[11]=-(e*(h*M-t*d)-f*(i*M-c*d)+l*(i*t-c*h)),n[12]=-(f*(d*x-v*p)-l*(h*x-a*p)+y*(h*v-a*d)),n[13]=e*(d*x-v*p)-l*(i*x-s*p)+y*(i*v-s*d),n[14]=-(e*(h*x-a*p)-f*(i*x-s*p)+y*(i*a-s*h)),n[15]=e*(h*v-a*d)-f*(i*v-s*d)+l*(i*a-s*h),n};B.determinant=function(n){var r=n[0],e=n[1],i=n[2],s=n[3],c=n[4],f=n[5],h=n[6],a=n[7],t=n[8],l=n[9],d=n[10],v=n[11],M=n[12],y=n[13],p=n[14],x=n[15],w=r*f-e*c,R=r*h-i*c,g=r*a-s*c,_=e*h-i*f,z=e*a-s*f,m=i*a-s*h,I=t*y-l*M,Y=t*p-d*M,E=t*x-v*M,S=l*p-d*y,W=l*x-v*y,F=d*x-v*p;return w*F-R*W+g*S+_*E-z*Y+m*I};B.multiply=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3],h=r[4],a=r[5],t=r[6],l=r[7],d=r[8],v=r[9],M=r[10],y=r[11],p=r[12],x=r[13],w=r[14],R=r[15],g=e[0],_=e[1],z=e[2],m=e[3];return n[0]=g*i+_*h+z*d+m*p,n[1]=g*s+_*a+z*v+m*x,n[2]=g*c+_*t+z*M+m*w,n[3]=g*f+_*l+z*y+m*R,g=e[4],_=e[5],z=e[6],m=e[7],n[4]=g*i+_*h+z*d+m*p,n[5]=g*s+_*a+z*v+m*x,n[6]=g*c+_*t+z*M+m*w,n[7]=g*f+_*l+z*y+m*R,g=e[8],_=e[9],z=e[10],m=e[11],n[8]=g*i+_*h+z*d+m*p,n[9]=g*s+_*a+z*v+m*x,n[10]=g*c+_*t+z*M+m*w,n[11]=g*f+_*l+z*y+m*R,g=e[12],_=e[13],z=e[14],m=e[15],n[12]=g*i+_*h+z*d+m*p,n[13]=g*s+_*a+z*v+m*x,n[14]=g*c+_*t+z*M+m*w,n[15]=g*f+_*l+z*y+m*R,n};B.mul=B.multiply;B.translate=function(n,r,e){var i=e[0],s=e[1],c=e[2],f,h,a,t,l,d,v,M,y,p,x,w;return r===n?(n[12]=r[0]*i+r[4]*s+r[8]*c+r[12],n[13]=r[1]*i+r[5]*s+r[9]*c+r[13],n[14]=r[2]*i+r[6]*s+r[10]*c+r[14],n[15]=r[3]*i+r[7]*s+r[11]*c+r[15]):(f=r[0],h=r[1],a=r[2],t=r[3],l=r[4],d=r[5],v=r[6],M=r[7],y=r[8],p=r[9],x=r[10],w=r[11],n[0]=f,n[1]=h,n[2]=a,n[3]=t,n[4]=l,n[5]=d,n[6]=v,n[7]=M,n[8]=y,n[9]=p,n[10]=x,n[11]=w,n[12]=f*i+l*s+y*c+r[12],n[13]=h*i+d*s+p*c+r[13],n[14]=a*i+v*s+x*c+r[14],n[15]=t*i+M*s+w*c+r[15]),n};B.scale=function(n,r,e){var i=e[0],s=e[1],c=e[2];return n[0]=r[0]*i,n[1]=r[1]*i,n[2]=r[2]*i,n[3]=r[3]*i,n[4]=r[4]*s,n[5]=r[5]*s,n[6]=r[6]*s,n[7]=r[7]*s,n[8]=r[8]*c,n[9]=r[9]*c,n[10]=r[10]*c,n[11]=r[11]*c,n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],n};B.rotate=function(n,r,e,i){var s=i[0],c=i[1],f=i[2],h=Math.sqrt(s*s+c*c+f*f),a,t,l,d,v,M,y,p,x,w,R,g,_,z,m,I,Y,E,S,W,F,j,A,J;return Math.abs(h)<h1.EPSILON?null:(h=1/h,s*=h,c*=h,f*=h,a=Math.sin(e),t=Math.cos(e),l=1-t,d=r[0],v=r[1],M=r[2],y=r[3],p=r[4],x=r[5],w=r[6],R=r[7],g=r[8],_=r[9],z=r[10],m=r[11],I=s*s*l+t,Y=c*s*l+f*a,E=f*s*l-c*a,S=s*c*l-f*a,W=c*c*l+t,F=f*c*l+s*a,j=s*f*l+c*a,A=c*f*l-s*a,J=f*f*l+t,n[0]=d*I+p*Y+g*E,n[1]=v*I+x*Y+_*E,n[2]=M*I+w*Y+z*E,n[3]=y*I+R*Y+m*E,n[4]=d*S+p*W+g*F,n[5]=v*S+x*W+_*F,n[6]=M*S+w*W+z*F,n[7]=y*S+R*W+m*F,n[8]=d*j+p*A+g*J,n[9]=v*j+x*A+_*J,n[10]=M*j+w*A+z*J,n[11]=y*j+R*A+m*J,r!==n&&(n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15]),n)};B.rotateX=function(n,r,e){var i=Math.sin(e),s=Math.cos(e),c=r[4],f=r[5],h=r[6],a=r[7],t=r[8],l=r[9],d=r[10],v=r[11];return r!==n&&(n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15]),n[4]=c*s+t*i,n[5]=f*s+l*i,n[6]=h*s+d*i,n[7]=a*s+v*i,n[8]=t*s-c*i,n[9]=l*s-f*i,n[10]=d*s-h*i,n[11]=v*s-a*i,n};B.rotateY=function(n,r,e){var i=Math.sin(e),s=Math.cos(e),c=r[0],f=r[1],h=r[2],a=r[3],t=r[8],l=r[9],d=r[10],v=r[11];return r!==n&&(n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15]),n[0]=c*s-t*i,n[1]=f*s-l*i,n[2]=h*s-d*i,n[3]=a*s-v*i,n[8]=c*i+t*s,n[9]=f*i+l*s,n[10]=h*i+d*s,n[11]=a*i+v*s,n};B.rotateZ=function(n,r,e){var i=Math.sin(e),s=Math.cos(e),c=r[0],f=r[1],h=r[2],a=r[3],t=r[4],l=r[5],d=r[6],v=r[7];return r!==n&&(n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15]),n[0]=c*s+t*i,n[1]=f*s+l*i,n[2]=h*s+d*i,n[3]=a*s+v*i,n[4]=t*s-c*i,n[5]=l*s-f*i,n[6]=d*s-h*i,n[7]=v*s-a*i,n};B.fromTranslation=function(n,r){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=r[0],n[13]=r[1],n[14]=r[2],n[15]=1,n};B.fromScaling=function(n,r){return n[0]=r[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=r[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=r[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n};B.fromRotation=function(n,r,e){var i=e[0],s=e[1],c=e[2],f=Math.sqrt(i*i+s*s+c*c),h,a,t;return Math.abs(f)<h1.EPSILON?null:(f=1/f,i*=f,s*=f,c*=f,h=Math.sin(r),a=Math.cos(r),t=1-a,n[0]=i*i*t+a,n[1]=s*i*t+c*h,n[2]=c*i*t-s*h,n[3]=0,n[4]=i*s*t-c*h,n[5]=s*s*t+a,n[6]=c*s*t+i*h,n[7]=0,n[8]=i*c*t+s*h,n[9]=s*c*t-i*h,n[10]=c*c*t+a,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n)};B.fromXRotation=function(n,r){var e=Math.sin(r),i=Math.cos(r);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=i,n[6]=e,n[7]=0,n[8]=0,n[9]=-e,n[10]=i,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n};B.fromYRotation=function(n,r){var e=Math.sin(r),i=Math.cos(r);return n[0]=i,n[1]=0,n[2]=-e,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=e,n[9]=0,n[10]=i,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n};B.fromZRotation=function(n,r){var e=Math.sin(r),i=Math.cos(r);return n[0]=i,n[1]=e,n[2]=0,n[3]=0,n[4]=-e,n[5]=i,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n};B.fromRotationTranslation=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3],h=i+i,a=s+s,t=c+c,l=i*h,d=i*a,v=i*t,M=s*a,y=s*t,p=c*t,x=f*h,w=f*a,R=f*t;return n[0]=1-(M+p),n[1]=d+R,n[2]=v-w,n[3]=0,n[4]=d-R,n[5]=1-(l+p),n[6]=y+x,n[7]=0,n[8]=v+w,n[9]=y-x,n[10]=1-(l+M),n[11]=0,n[12]=e[0],n[13]=e[1],n[14]=e[2],n[15]=1,n};B.fromRotationTranslationScale=function(n,r,e,i){var s=r[0],c=r[1],f=r[2],h=r[3],a=s+s,t=c+c,l=f+f,d=s*a,v=s*t,M=s*l,y=c*t,p=c*l,x=f*l,w=h*a,R=h*t,g=h*l,_=i[0],z=i[1],m=i[2];return n[0]=(1-(y+x))*_,n[1]=(v+g)*_,n[2]=(M-R)*_,n[3]=0,n[4]=(v-g)*z,n[5]=(1-(d+x))*z,n[6]=(p+w)*z,n[7]=0,n[8]=(M+R)*m,n[9]=(p-w)*m,n[10]=(1-(d+y))*m,n[11]=0,n[12]=e[0],n[13]=e[1],n[14]=e[2],n[15]=1,n};B.fromRotationTranslationScaleOrigin=function(n,r,e,i,s){var c=r[0],f=r[1],h=r[2],a=r[3],t=c+c,l=f+f,d=h+h,v=c*t,M=c*l,y=c*d,p=f*l,x=f*d,w=h*d,R=a*t,g=a*l,_=a*d,z=i[0],m=i[1],I=i[2],Y=s[0],E=s[1],S=s[2];return n[0]=(1-(p+w))*z,n[1]=(M+_)*z,n[2]=(y-g)*z,n[3]=0,n[4]=(M-_)*m,n[5]=(1-(v+w))*m,n[6]=(x+R)*m,n[7]=0,n[8]=(y+g)*I,n[9]=(x-R)*I,n[10]=(1-(v+p))*I,n[11]=0,n[12]=e[0]+Y-(n[0]*Y+n[4]*E+n[8]*S),n[13]=e[1]+E-(n[1]*Y+n[5]*E+n[9]*S),n[14]=e[2]+S-(n[2]*Y+n[6]*E+n[10]*S),n[15]=1,n};B.fromQuat=function(n,r){var e=r[0],i=r[1],s=r[2],c=r[3],f=e+e,h=i+i,a=s+s,t=e*f,l=i*f,d=i*h,v=s*f,M=s*h,y=s*a,p=c*f,x=c*h,w=c*a;return n[0]=1-d-y,n[1]=l+w,n[2]=v-x,n[3]=0,n[4]=l-w,n[5]=1-t-y,n[6]=M+p,n[7]=0,n[8]=v+x,n[9]=M-p,n[10]=1-t-d,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n};B.frustum=function(n,r,e,i,s,c,f){var h=1/(e-r),a=1/(s-i),t=1/(c-f);return n[0]=c*2*h,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=c*2*a,n[6]=0,n[7]=0,n[8]=(e+r)*h,n[9]=(s+i)*a,n[10]=(f+c)*t,n[11]=-1,n[12]=0,n[13]=0,n[14]=f*c*2*t,n[15]=0,n};B.perspective=function(n,r,e,i,s){var c=1/Math.tan(r/2),f=1/(i-s);return n[0]=c/e,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=c,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=(s+i)*f,n[11]=-1,n[12]=0,n[13]=0,n[14]=2*s*i*f,n[15]=0,n};B.perspectiveFromFieldOfView=function(n,r,e,i){var s=Math.tan(r.upDegrees*Math.PI/180),c=Math.tan(r.downDegrees*Math.PI/180),f=Math.tan(r.leftDegrees*Math.PI/180),h=Math.tan(r.rightDegrees*Math.PI/180),a=2/(f+h),t=2/(s+c);return n[0]=a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=t,n[6]=0,n[7]=0,n[8]=-((f-h)*a*.5),n[9]=(s-c)*t*.5,n[10]=i/(e-i),n[11]=-1,n[12]=0,n[13]=0,n[14]=i*e/(e-i),n[15]=0,n};B.ortho=function(n,r,e,i,s,c,f){var h=1/(r-e),a=1/(i-s),t=1/(c-f);return n[0]=-2*h,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*a,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*t,n[11]=0,n[12]=(r+e)*h,n[13]=(s+i)*a,n[14]=(f+c)*t,n[15]=1,n};B.lookAt=function(n,r,e,i){var s,c,f,h,a,t,l,d,v,M,y=r[0],p=r[1],x=r[2],w=i[0],R=i[1],g=i[2],_=e[0],z=e[1],m=e[2];return Math.abs(y-_)<h1.EPSILON&&Math.abs(p-z)<h1.EPSILON&&Math.abs(x-m)<h1.EPSILON?B.identity(n):(l=y-_,d=p-z,v=x-m,M=1/Math.sqrt(l*l+d*d+v*v),l*=M,d*=M,v*=M,s=R*v-g*d,c=g*l-w*v,f=w*d-R*l,M=Math.sqrt(s*s+c*c+f*f),M?(M=1/M,s*=M,c*=M,f*=M):(s=0,c=0,f=0),h=d*f-v*c,a=v*s-l*f,t=l*c-d*s,M=Math.sqrt(h*h+a*a+t*t),M?(M=1/M,h*=M,a*=M,t*=M):(h=0,a=0,t=0),n[0]=s,n[1]=h,n[2]=l,n[3]=0,n[4]=c,n[5]=a,n[6]=d,n[7]=0,n[8]=f,n[9]=t,n[10]=v,n[11]=0,n[12]=-(s*y+c*p+f*x),n[13]=-(h*y+a*p+t*x),n[14]=-(l*y+d*p+v*x),n[15]=1,n)};B.str=function(n){return"mat4("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+", "+n[6]+", "+n[7]+", "+n[8]+", "+n[9]+", "+n[10]+", "+n[11]+", "+n[12]+", "+n[13]+", "+n[14]+", "+n[15]+")"};B.frob=function(n){return Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2)+Math.pow(n[2],2)+Math.pow(n[3],2)+Math.pow(n[4],2)+Math.pow(n[5],2)+Math.pow(n[6],2)+Math.pow(n[7],2)+Math.pow(n[8],2)+Math.pow(n[9],2)+Math.pow(n[10],2)+Math.pow(n[11],2)+Math.pow(n[12],2)+Math.pow(n[13],2)+Math.pow(n[14],2)+Math.pow(n[15],2))};var u1=B,y1=i1,P={};P.create=function(){var n=new y1.ARRAY_TYPE(3);return n[0]=0,n[1]=0,n[2]=0,n};P.clone=function(n){var r=new y1.ARRAY_TYPE(3);return r[0]=n[0],r[1]=n[1],r[2]=n[2],r};P.fromValues=function(n,r,e){var i=new y1.ARRAY_TYPE(3);return i[0]=n,i[1]=r,i[2]=e,i};P.copy=function(n,r){return n[0]=r[0],n[1]=r[1],n[2]=r[2],n};P.set=function(n,r,e,i){return n[0]=r,n[1]=e,n[2]=i,n};P.add=function(n,r,e){return n[0]=r[0]+e[0],n[1]=r[1]+e[1],n[2]=r[2]+e[2],n};P.subtract=function(n,r,e){return n[0]=r[0]-e[0],n[1]=r[1]-e[1],n[2]=r[2]-e[2],n};P.sub=P.subtract;P.multiply=function(n,r,e){return n[0]=r[0]*e[0],n[1]=r[1]*e[1],n[2]=r[2]*e[2],n};P.mul=P.multiply;P.divide=function(n,r,e){return n[0]=r[0]/e[0],n[1]=r[1]/e[1],n[2]=r[2]/e[2],n};P.div=P.divide;P.min=function(n,r,e){return n[0]=Math.min(r[0],e[0]),n[1]=Math.min(r[1],e[1]),n[2]=Math.min(r[2],e[2]),n};P.max=function(n,r,e){return n[0]=Math.max(r[0],e[0]),n[1]=Math.max(r[1],e[1]),n[2]=Math.max(r[2],e[2]),n};P.scale=function(n,r,e){return n[0]=r[0]*e,n[1]=r[1]*e,n[2]=r[2]*e,n};P.scaleAndAdd=function(n,r,e,i){return n[0]=r[0]+e[0]*i,n[1]=r[1]+e[1]*i,n[2]=r[2]+e[2]*i,n};P.distance=function(n,r){var e=r[0]-n[0],i=r[1]-n[1],s=r[2]-n[2];return Math.sqrt(e*e+i*i+s*s)};P.dist=P.distance;P.squaredDistance=function(n,r){var e=r[0]-n[0],i=r[1]-n[1],s=r[2]-n[2];return e*e+i*i+s*s};P.sqrDist=P.squaredDistance;P.length=function(n){var r=n[0],e=n[1],i=n[2];return Math.sqrt(r*r+e*e+i*i)};P.len=P.length;P.squaredLength=function(n){var r=n[0],e=n[1],i=n[2];return r*r+e*e+i*i};P.sqrLen=P.squaredLength;P.negate=function(n,r){return n[0]=-r[0],n[1]=-r[1],n[2]=-r[2],n};P.inverse=function(n,r){return n[0]=1/r[0],n[1]=1/r[1],n[2]=1/r[2],n};P.normalize=function(n,r){var e=r[0],i=r[1],s=r[2],c=e*e+i*i+s*s;return c>0&&(c=1/Math.sqrt(c),n[0]=r[0]*c,n[1]=r[1]*c,n[2]=r[2]*c),n};P.dot=function(n,r){return n[0]*r[0]+n[1]*r[1]+n[2]*r[2]};P.cross=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=e[0],h=e[1],a=e[2];return n[0]=s*a-c*h,n[1]=c*f-i*a,n[2]=i*h-s*f,n};P.lerp=function(n,r,e,i){var s=r[0],c=r[1],f=r[2];return n[0]=s+i*(e[0]-s),n[1]=c+i*(e[1]-c),n[2]=f+i*(e[2]-f),n};P.hermite=function(n,r,e,i,s,c){var f=c*c,h=f*(2*c-3)+1,a=f*(c-2)+c,t=f*(c-1),l=f*(3-2*c);return n[0]=r[0]*h+e[0]*a+i[0]*t+s[0]*l,n[1]=r[1]*h+e[1]*a+i[1]*t+s[1]*l,n[2]=r[2]*h+e[2]*a+i[2]*t+s[2]*l,n};P.bezier=function(n,r,e,i,s,c){var f=1-c,h=f*f,a=c*c,t=h*f,l=3*c*h,d=3*a*f,v=a*c;return n[0]=r[0]*t+e[0]*l+i[0]*d+s[0]*v,n[1]=r[1]*t+e[1]*l+i[1]*d+s[1]*v,n[2]=r[2]*t+e[2]*l+i[2]*d+s[2]*v,n};P.random=function(n,r){r=r||1;var e=y1.RANDOM()*2*Math.PI,i=y1.RANDOM()*2-1,s=Math.sqrt(1-i*i)*r;return n[0]=Math.cos(e)*s,n[1]=Math.sin(e)*s,n[2]=i*r,n};P.transformMat4=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=e[3]*i+e[7]*s+e[11]*c+e[15];return f=f||1,n[0]=(e[0]*i+e[4]*s+e[8]*c+e[12])/f,n[1]=(e[1]*i+e[5]*s+e[9]*c+e[13])/f,n[2]=(e[2]*i+e[6]*s+e[10]*c+e[14])/f,n};P.transformMat3=function(n,r,e){var i=r[0],s=r[1],c=r[2];return n[0]=i*e[0]+s*e[3]+c*e[6],n[1]=i*e[1]+s*e[4]+c*e[7],n[2]=i*e[2]+s*e[5]+c*e[8],n};P.transformQuat=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=e[0],h=e[1],a=e[2],t=e[3],l=t*i+h*c-a*s,d=t*s+a*i-f*c,v=t*c+f*s-h*i,M=-f*i-h*s-a*c;return n[0]=l*t+M*-f+d*-a-v*-h,n[1]=d*t+M*-h+v*-f-l*-a,n[2]=v*t+M*-a+l*-h-d*-f,n};P.rotateX=function(n,r,e,i){var s=[],c=[];return s[0]=r[0]-e[0],s[1]=r[1]-e[1],s[2]=r[2]-e[2],c[0]=s[0],c[1]=s[1]*Math.cos(i)-s[2]*Math.sin(i),c[2]=s[1]*Math.sin(i)+s[2]*Math.cos(i),n[0]=c[0]+e[0],n[1]=c[1]+e[1],n[2]=c[2]+e[2],n};P.rotateY=function(n,r,e,i){var s=[],c=[];return s[0]=r[0]-e[0],s[1]=r[1]-e[1],s[2]=r[2]-e[2],c[0]=s[2]*Math.sin(i)+s[0]*Math.cos(i),c[1]=s[1],c[2]=s[2]*Math.cos(i)-s[0]*Math.sin(i),n[0]=c[0]+e[0],n[1]=c[1]+e[1],n[2]=c[2]+e[2],n};P.rotateZ=function(n,r,e,i){var s=[],c=[];return s[0]=r[0]-e[0],s[1]=r[1]-e[1],s[2]=r[2]-e[2],c[0]=s[0]*Math.cos(i)-s[1]*Math.sin(i),c[1]=s[0]*Math.sin(i)+s[1]*Math.cos(i),c[2]=s[2],n[0]=c[0]+e[0],n[1]=c[1]+e[1],n[2]=c[2]+e[2],n};P.forEach=function(){var n=P.create();return function(r,e,i,s,c,f){var h,a;for(e||(e=3),i||(i=0),s?a=Math.min(s*e+i,r.length):a=r.length,h=i;h<a;h+=e)n[0]=r[h],n[1]=r[h+1],n[2]=r[h+2],c(n,n,f),r[h]=n[0],r[h+1]=n[1],r[h+2]=n[2];return r}}();P.angle=function(n,r){var e=P.fromValues(n[0],n[1],n[2]),i=P.fromValues(r[0],r[1],r[2]);P.normalize(e,e),P.normalize(i,i);var s=P.dot(e,i);return s>1?0:Math.acos(s)};P.str=function(n){return"vec3("+n[0]+", "+n[1]+", "+n[2]+")"};var D1=P,c1=i1,q={};q.create=function(){var n=new c1.ARRAY_TYPE(4);return n[0]=0,n[1]=0,n[2]=0,n[3]=0,n};q.clone=function(n){var r=new c1.ARRAY_TYPE(4);return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r};q.fromValues=function(n,r,e,i){var s=new c1.ARRAY_TYPE(4);return s[0]=n,s[1]=r,s[2]=e,s[3]=i,s};q.copy=function(n,r){return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n};q.set=function(n,r,e,i,s){return n[0]=r,n[1]=e,n[2]=i,n[3]=s,n};q.add=function(n,r,e){return n[0]=r[0]+e[0],n[1]=r[1]+e[1],n[2]=r[2]+e[2],n[3]=r[3]+e[3],n};q.subtract=function(n,r,e){return n[0]=r[0]-e[0],n[1]=r[1]-e[1],n[2]=r[2]-e[2],n[3]=r[3]-e[3],n};q.sub=q.subtract;q.multiply=function(n,r,e){return n[0]=r[0]*e[0],n[1]=r[1]*e[1],n[2]=r[2]*e[2],n[3]=r[3]*e[3],n};q.mul=q.multiply;q.divide=function(n,r,e){return n[0]=r[0]/e[0],n[1]=r[1]/e[1],n[2]=r[2]/e[2],n[3]=r[3]/e[3],n};q.div=q.divide;q.min=function(n,r,e){return n[0]=Math.min(r[0],e[0]),n[1]=Math.min(r[1],e[1]),n[2]=Math.min(r[2],e[2]),n[3]=Math.min(r[3],e[3]),n};q.max=function(n,r,e){return n[0]=Math.max(r[0],e[0]),n[1]=Math.max(r[1],e[1]),n[2]=Math.max(r[2],e[2]),n[3]=Math.max(r[3],e[3]),n};q.scale=function(n,r,e){return n[0]=r[0]*e,n[1]=r[1]*e,n[2]=r[2]*e,n[3]=r[3]*e,n};q.scaleAndAdd=function(n,r,e,i){return n[0]=r[0]+e[0]*i,n[1]=r[1]+e[1]*i,n[2]=r[2]+e[2]*i,n[3]=r[3]+e[3]*i,n};q.distance=function(n,r){var e=r[0]-n[0],i=r[1]-n[1],s=r[2]-n[2],c=r[3]-n[3];return Math.sqrt(e*e+i*i+s*s+c*c)};q.dist=q.distance;q.squaredDistance=function(n,r){var e=r[0]-n[0],i=r[1]-n[1],s=r[2]-n[2],c=r[3]-n[3];return e*e+i*i+s*s+c*c};q.sqrDist=q.squaredDistance;q.length=function(n){var r=n[0],e=n[1],i=n[2],s=n[3];return Math.sqrt(r*r+e*e+i*i+s*s)};q.len=q.length;q.squaredLength=function(n){var r=n[0],e=n[1],i=n[2],s=n[3];return r*r+e*e+i*i+s*s};q.sqrLen=q.squaredLength;q.negate=function(n,r){return n[0]=-r[0],n[1]=-r[1],n[2]=-r[2],n[3]=-r[3],n};q.inverse=function(n,r){return n[0]=1/r[0],n[1]=1/r[1],n[2]=1/r[2],n[3]=1/r[3],n};q.normalize=function(n,r){var e=r[0],i=r[1],s=r[2],c=r[3],f=e*e+i*i+s*s+c*c;return f>0&&(f=1/Math.sqrt(f),n[0]=e*f,n[1]=i*f,n[2]=s*f,n[3]=c*f),n};q.dot=function(n,r){return n[0]*r[0]+n[1]*r[1]+n[2]*r[2]+n[3]*r[3]};q.lerp=function(n,r,e,i){var s=r[0],c=r[1],f=r[2],h=r[3];return n[0]=s+i*(e[0]-s),n[1]=c+i*(e[1]-c),n[2]=f+i*(e[2]-f),n[3]=h+i*(e[3]-h),n};q.random=function(n,r){return r=r||1,n[0]=c1.RANDOM(),n[1]=c1.RANDOM(),n[2]=c1.RANDOM(),n[3]=c1.RANDOM(),q.normalize(n,n),q.scale(n,n,r),n};q.transformMat4=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3];return n[0]=e[0]*i+e[4]*s+e[8]*c+e[12]*f,n[1]=e[1]*i+e[5]*s+e[9]*c+e[13]*f,n[2]=e[2]*i+e[6]*s+e[10]*c+e[14]*f,n[3]=e[3]*i+e[7]*s+e[11]*c+e[15]*f,n};q.transformQuat=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=e[0],h=e[1],a=e[2],t=e[3],l=t*i+h*c-a*s,d=t*s+a*i-f*c,v=t*c+f*s-h*i,M=-f*i-h*s-a*c;return n[0]=l*t+M*-f+d*-a-v*-h,n[1]=d*t+M*-h+v*-f-l*-a,n[2]=v*t+M*-a+l*-h-d*-f,n[3]=r[3],n};q.forEach=function(){var n=q.create();return function(r,e,i,s,c,f){var h,a;for(e||(e=4),i||(i=0),s?a=Math.min(s*e+i,r.length):a=r.length,h=i;h<a;h+=e)n[0]=r[h],n[1]=r[h+1],n[2]=r[h+2],n[3]=r[h+3],c(n,n,f),r[h]=n[0],r[h+1]=n[1],r[h+2]=n[2],r[h+3]=n[3];return r}}();q.str=function(n){return"vec4("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+")"};var o1=q,nn=i1,rn=b1,o=D1,k=o1,V={};V.create=function(){var n=new nn.ARRAY_TYPE(4);return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n};V.rotationTo=function(){var n=o.create(),r=o.fromValues(1,0,0),e=o.fromValues(0,1,0);return function(i,s,c){var f=o.dot(s,c);return f<-.999999?(o.cross(n,r,s),o.length(n)<1e-6&&o.cross(n,e,s),o.normalize(n,n),V.setAxisAngle(i,n,Math.PI),i):f>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(o.cross(n,s,c),i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=1+f,V.normalize(i,i))}}();V.setAxes=function(){var n=rn.create();return function(r,e,i,s){return n[0]=i[0],n[3]=i[1],n[6]=i[2],n[1]=s[0],n[4]=s[1],n[7]=s[2],n[2]=-e[0],n[5]=-e[1],n[8]=-e[2],V.normalize(r,V.fromMat3(r,n))}}();V.clone=k.clone;V.fromValues=k.fromValues;V.copy=k.copy;V.set=k.set;V.identity=function(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n};V.setAxisAngle=function(n,r,e){e=e*.5;var i=Math.sin(e);return n[0]=i*r[0],n[1]=i*r[1],n[2]=i*r[2],n[3]=Math.cos(e),n};V.add=k.add;V.multiply=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3],h=e[0],a=e[1],t=e[2],l=e[3];return n[0]=i*l+f*h+s*t-c*a,n[1]=s*l+f*a+c*h-i*t,n[2]=c*l+f*t+i*a-s*h,n[3]=f*l-i*h-s*a-c*t,n};V.mul=V.multiply;V.scale=k.scale;V.rotateX=function(n,r,e){e*=.5;var i=r[0],s=r[1],c=r[2],f=r[3],h=Math.sin(e),a=Math.cos(e);return n[0]=i*a+f*h,n[1]=s*a+c*h,n[2]=c*a-s*h,n[3]=f*a-i*h,n};V.rotateY=function(n,r,e){e*=.5;var i=r[0],s=r[1],c=r[2],f=r[3],h=Math.sin(e),a=Math.cos(e);return n[0]=i*a-c*h,n[1]=s*a+f*h,n[2]=c*a+i*h,n[3]=f*a-s*h,n};V.rotateZ=function(n,r,e){e*=.5;var i=r[0],s=r[1],c=r[2],f=r[3],h=Math.sin(e),a=Math.cos(e);return n[0]=i*a+s*h,n[1]=s*a-i*h,n[2]=c*a+f*h,n[3]=f*a-c*h,n};V.calculateW=function(n,r){var e=r[0],i=r[1],s=r[2];return n[0]=e,n[1]=i,n[2]=s,n[3]=Math.sqrt(Math.abs(1-e*e-i*i-s*s)),n};V.dot=k.dot;V.lerp=k.lerp;V.slerp=function(n,r,e,i){var s=r[0],c=r[1],f=r[2],h=r[3],a=e[0],t=e[1],l=e[2],d=e[3],v,M,y,p,x;return M=s*a+c*t+f*l+h*d,M<0&&(M=-M,a=-a,t=-t,l=-l,d=-d),1-M>1e-6?(v=Math.acos(M),y=Math.sin(v),p=Math.sin((1-i)*v)/y,x=Math.sin(i*v)/y):(p=1-i,x=i),n[0]=p*s+x*a,n[1]=p*c+x*t,n[2]=p*f+x*l,n[3]=p*h+x*d,n};V.sqlerp=function(){var n=V.create(),r=V.create();return function(e,i,s,c,f,h){return V.slerp(n,i,f,h),V.slerp(r,s,c,h),V.slerp(e,n,r,2*h*(1-h)),e}}();V.invert=function(n,r){var e=r[0],i=r[1],s=r[2],c=r[3],f=e*e+i*i+s*s+c*c,h=f?1/f:0;return n[0]=-e*h,n[1]=-i*h,n[2]=-s*h,n[3]=c*h,n};V.conjugate=function(n,r){return n[0]=-r[0],n[1]=-r[1],n[2]=-r[2],n[3]=r[3],n};V.length=k.length;V.len=V.length;V.squaredLength=k.squaredLength;V.sqrLen=V.squaredLength;V.normalize=k.normalize;V.fromMat3=function(n,r){var e=r[0]+r[4]+r[8],i;if(e>0)i=Math.sqrt(e+1),n[3]=.5*i,i=.5/i,n[0]=(r[5]-r[7])*i,n[1]=(r[6]-r[2])*i,n[2]=(r[1]-r[3])*i;else{var s=0;r[4]>r[0]&&(s=1),r[8]>r[s*3+s]&&(s=2);var c=(s+1)%3,f=(s+2)%3;i=Math.sqrt(r[s*3+s]-r[c*3+c]-r[f*3+f]+1),n[s]=.5*i,i=.5/i,n[3]=(r[c*3+f]-r[f*3+c])*i,n[c]=(r[c*3+s]+r[s*3+c])*i,n[f]=(r[f*3+s]+r[s*3+f])*i}return n};V.str=function(n){return"quat("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+")"};var _1=i1,D={};D.create=function(){var n=new _1.ARRAY_TYPE(2);return n[0]=0,n[1]=0,n};D.clone=function(n){var r=new _1.ARRAY_TYPE(2);return r[0]=n[0],r[1]=n[1],r};D.fromValues=function(n,r){var e=new _1.ARRAY_TYPE(2);return e[0]=n,e[1]=r,e};D.copy=function(n,r){return n[0]=r[0],n[1]=r[1],n};D.set=function(n,r,e){return n[0]=r,n[1]=e,n};D.add=function(n,r,e){return n[0]=r[0]+e[0],n[1]=r[1]+e[1],n};D.subtract=function(n,r,e){return n[0]=r[0]-e[0],n[1]=r[1]-e[1],n};D.sub=D.subtract;D.multiply=function(n,r,e){return n[0]=r[0]*e[0],n[1]=r[1]*e[1],n};D.mul=D.multiply;D.divide=function(n,r,e){return n[0]=r[0]/e[0],n[1]=r[1]/e[1],n};D.div=D.divide;D.min=function(n,r,e){return n[0]=Math.min(r[0],e[0]),n[1]=Math.min(r[1],e[1]),n};D.max=function(n,r,e){return n[0]=Math.max(r[0],e[0]),n[1]=Math.max(r[1],e[1]),n};D.scale=function(n,r,e){return n[0]=r[0]*e,n[1]=r[1]*e,n};D.scaleAndAdd=function(n,r,e,i){return n[0]=r[0]+e[0]*i,n[1]=r[1]+e[1]*i,n};D.distance=function(n,r){var e=r[0]-n[0],i=r[1]-n[1];return Math.sqrt(e*e+i*i)};D.dist=D.distance;D.squaredDistance=function(n,r){var e=r[0]-n[0],i=r[1]-n[1];return e*e+i*i};D.sqrDist=D.squaredDistance;D.length=function(n){var r=n[0],e=n[1];return Math.sqrt(r*r+e*e)};D.len=D.length;D.squaredLength=function(n){var r=n[0],e=n[1];return r*r+e*e};D.sqrLen=D.squaredLength;D.negate=function(n,r){return n[0]=-r[0],n[1]=-r[1],n};D.inverse=function(n,r){return n[0]=1/r[0],n[1]=1/r[1],n};D.normalize=function(n,r){var e=r[0],i=r[1],s=e*e+i*i;return s>0&&(s=1/Math.sqrt(s),n[0]=r[0]*s,n[1]=r[1]*s),n};D.dot=function(n,r){return n[0]*r[0]+n[1]*r[1]};D.cross=function(n,r,e){var i=r[0]*e[1]-r[1]*e[0];return n[0]=n[1]=0,n[2]=i,n};D.lerp=function(n,r,e,i){var s=r[0],c=r[1];return n[0]=s+i*(e[0]-s),n[1]=c+i*(e[1]-c),n};D.random=function(n,r){r=r||1;var e=_1.RANDOM()*2*Math.PI;return n[0]=Math.cos(e)*r,n[1]=Math.sin(e)*r,n};D.transformMat2=function(n,r,e){var i=r[0],s=r[1];return n[0]=e[0]*i+e[2]*s,n[1]=e[1]*i+e[3]*s,n};D.transformMat2d=function(n,r,e){var i=r[0],s=r[1];return n[0]=e[0]*i+e[2]*s+e[4],n[1]=e[1]*i+e[3]*s+e[5],n};D.transformMat3=function(n,r,e){var i=r[0],s=r[1];return n[0]=e[0]*i+e[3]*s+e[6],n[1]=e[1]*i+e[4]*s+e[7],n};D.transformMat4=function(n,r,e){var i=r[0],s=r[1];return n[0]=e[0]*i+e[4]*s+e[12],n[1]=e[1]*i+e[5]*s+e[13],n};D.forEach=function(){var n=D.create();return function(r,e,i,s,c,f){var h,a;for(e||(e=2),i||(i=0),s?a=Math.min(s*e+i,r.length):a=r.length,h=i;h<a;h+=e)n[0]=r[h],n[1]=r[h+1],c(n,n,f),r[h]=n[0],r[h+1]=n[1];return r}}();D.str=function(n){return"vec2("+n[0]+", "+n[1]+")"};var K=u1,en=D1,M1={};M1.EPSILON=1e-6;M1.ARRAY_TYPE=typeof Float32Array<"u"?Float32Array:Array;M1.RANDOM=Math.random;M1.setMatrixArrayType=function(n){GLMAT_ARRAY_TYPE=n};var sn=Math.PI/180;M1.toRadian=function(n){return n*sn};var s1=M1,O1=s1,Q={};Q.create=function(){var n=new O1.ARRAY_TYPE(4);return n[0]=1,n[1]=0,n[2]=0,n[3]=1,n};Q.clone=function(n){var r=new O1.ARRAY_TYPE(4);return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r};Q.copy=function(n,r){return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n};Q.identity=function(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=1,n};Q.transpose=function(n,r){if(n===r){var e=r[1];n[1]=r[2],n[2]=e}else n[0]=r[0],n[1]=r[2],n[2]=r[1],n[3]=r[3];return n};Q.invert=function(n,r){var e=r[0],i=r[1],s=r[2],c=r[3],f=e*c-s*i;return f?(f=1/f,n[0]=c*f,n[1]=-i*f,n[2]=-s*f,n[3]=e*f,n):null};Q.adjoint=function(n,r){var e=r[0];return n[0]=r[3],n[1]=-r[1],n[2]=-r[2],n[3]=e,n};Q.determinant=function(n){return n[0]*n[3]-n[2]*n[1]};Q.multiply=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3],h=e[0],a=e[1],t=e[2],l=e[3];return n[0]=i*h+c*a,n[1]=s*h+f*a,n[2]=i*t+c*l,n[3]=s*t+f*l,n};Q.mul=Q.multiply;Q.rotate=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3],h=Math.sin(e),a=Math.cos(e);return n[0]=i*a+c*h,n[1]=s*a+f*h,n[2]=i*-h+c*a,n[3]=s*-h+f*a,n};Q.scale=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3],h=e[0],a=e[1];return n[0]=i*h,n[1]=s*h,n[2]=c*a,n[3]=f*a,n};Q.fromRotation=function(n,r){var e=Math.sin(r),i=Math.cos(r);return n[0]=i,n[1]=e,n[2]=-e,n[3]=i,n};Q.fromScaling=function(n,r){return n[0]=r[0],n[1]=0,n[2]=0,n[3]=r[1],n};Q.str=function(n){return"mat2("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+")"};Q.frob=function(n){return Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2)+Math.pow(n[2],2)+Math.pow(n[3],2))};Q.LDU=function(n,r,e,i){return n[2]=i[2]/i[0],e[0]=i[0],e[1]=i[1],e[3]=i[3]-n[2]*e[1],[n,r,e]};var I1=s1,H={};H.create=function(){var n=new I1.ARRAY_TYPE(6);return n[0]=1,n[1]=0,n[2]=0,n[3]=1,n[4]=0,n[5]=0,n};H.clone=function(n){var r=new I1.ARRAY_TYPE(6);return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r};H.copy=function(n,r){return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n};H.identity=function(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=1,n[4]=0,n[5]=0,n};H.invert=function(n,r){var e=r[0],i=r[1],s=r[2],c=r[3],f=r[4],h=r[5],a=e*c-i*s;return a?(a=1/a,n[0]=c*a,n[1]=-i*a,n[2]=-s*a,n[3]=e*a,n[4]=(s*h-c*f)*a,n[5]=(i*f-e*h)*a,n):null};H.determinant=function(n){return n[0]*n[3]-n[1]*n[2]};H.multiply=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3],h=r[4],a=r[5],t=e[0],l=e[1],d=e[2],v=e[3],M=e[4],y=e[5];return n[0]=i*t+c*l,n[1]=s*t+f*l,n[2]=i*d+c*v,n[3]=s*d+f*v,n[4]=i*M+c*y+h,n[5]=s*M+f*y+a,n};H.mul=H.multiply;H.rotate=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3],h=r[4],a=r[5],t=Math.sin(e),l=Math.cos(e);return n[0]=i*l+c*t,n[1]=s*l+f*t,n[2]=i*-t+c*l,n[3]=s*-t+f*l,n[4]=h,n[5]=a,n};H.scale=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3],h=r[4],a=r[5],t=e[0],l=e[1];return n[0]=i*t,n[1]=s*t,n[2]=c*l,n[3]=f*l,n[4]=h,n[5]=a,n};H.translate=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3],h=r[4],a=r[5],t=e[0],l=e[1];return n[0]=i,n[1]=s,n[2]=c,n[3]=f,n[4]=i*t+c*l+h,n[5]=s*t+f*l+a,n};H.fromRotation=function(n,r){var e=Math.sin(r),i=Math.cos(r);return n[0]=i,n[1]=e,n[2]=-e,n[3]=i,n[4]=0,n[5]=0,n};H.fromScaling=function(n,r){return n[0]=r[0],n[1]=0,n[2]=0,n[3]=r[1],n[4]=0,n[5]=0,n};H.fromTranslation=function(n,r){return n[0]=1,n[1]=0,n[2]=0,n[3]=1,n[4]=r[0],n[5]=r[1],n};H.str=function(n){return"mat2d("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+")"};H.frob=function(n){return Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2)+Math.pow(n[2],2)+Math.pow(n[3],2)+Math.pow(n[4],2)+Math.pow(n[5],2)+1)};var $1=s1,C={};C.create=function(){var n=new $1.ARRAY_TYPE(9);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=1,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n};C.fromMat4=function(n,r){return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[4],n[4]=r[5],n[5]=r[6],n[6]=r[8],n[7]=r[9],n[8]=r[10],n};C.clone=function(n){var r=new $1.ARRAY_TYPE(9);return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],r};C.copy=function(n,r){return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n};C.identity=function(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=1,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n};C.transpose=function(n,r){if(n===r){var e=r[1],i=r[2],s=r[5];n[1]=r[3],n[2]=r[6],n[3]=e,n[5]=r[7],n[6]=i,n[7]=s}else n[0]=r[0],n[1]=r[3],n[2]=r[6],n[3]=r[1],n[4]=r[4],n[5]=r[7],n[6]=r[2],n[7]=r[5],n[8]=r[8];return n};C.invert=function(n,r){var e=r[0],i=r[1],s=r[2],c=r[3],f=r[4],h=r[5],a=r[6],t=r[7],l=r[8],d=l*f-h*t,v=-l*c+h*a,M=t*c-f*a,y=e*d+i*v+s*M;return y?(y=1/y,n[0]=d*y,n[1]=(-l*i+s*t)*y,n[2]=(h*i-s*f)*y,n[3]=v*y,n[4]=(l*e-s*a)*y,n[5]=(-h*e+s*c)*y,n[6]=M*y,n[7]=(-t*e+i*a)*y,n[8]=(f*e-i*c)*y,n):null};C.adjoint=function(n,r){var e=r[0],i=r[1],s=r[2],c=r[3],f=r[4],h=r[5],a=r[6],t=r[7],l=r[8];return n[0]=f*l-h*t,n[1]=s*t-i*l,n[2]=i*h-s*f,n[3]=h*a-c*l,n[4]=e*l-s*a,n[5]=s*c-e*h,n[6]=c*t-f*a,n[7]=i*a-e*t,n[8]=e*f-i*c,n};C.determinant=function(n){var r=n[0],e=n[1],i=n[2],s=n[3],c=n[4],f=n[5],h=n[6],a=n[7],t=n[8];return r*(t*c-f*a)+e*(-t*s+f*h)+i*(a*s-c*h)};C.multiply=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3],h=r[4],a=r[5],t=r[6],l=r[7],d=r[8],v=e[0],M=e[1],y=e[2],p=e[3],x=e[4],w=e[5],R=e[6],g=e[7],_=e[8];return n[0]=v*i+M*f+y*t,n[1]=v*s+M*h+y*l,n[2]=v*c+M*a+y*d,n[3]=p*i+x*f+w*t,n[4]=p*s+x*h+w*l,n[5]=p*c+x*a+w*d,n[6]=R*i+g*f+_*t,n[7]=R*s+g*h+_*l,n[8]=R*c+g*a+_*d,n};C.mul=C.multiply;C.translate=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3],h=r[4],a=r[5],t=r[6],l=r[7],d=r[8],v=e[0],M=e[1];return n[0]=i,n[1]=s,n[2]=c,n[3]=f,n[4]=h,n[5]=a,n[6]=v*i+M*f+t,n[7]=v*s+M*h+l,n[8]=v*c+M*a+d,n};C.rotate=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3],h=r[4],a=r[5],t=r[6],l=r[7],d=r[8],v=Math.sin(e),M=Math.cos(e);return n[0]=M*i+v*f,n[1]=M*s+v*h,n[2]=M*c+v*a,n[3]=M*f-v*i,n[4]=M*h-v*s,n[5]=M*a-v*c,n[6]=t,n[7]=l,n[8]=d,n};C.scale=function(n,r,e){var i=e[0],s=e[1];return n[0]=i*r[0],n[1]=i*r[1],n[2]=i*r[2],n[3]=s*r[3],n[4]=s*r[4],n[5]=s*r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n};C.fromTranslation=function(n,r){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=1,n[5]=0,n[6]=r[0],n[7]=r[1],n[8]=1,n};C.fromRotation=function(n,r){var e=Math.sin(r),i=Math.cos(r);return n[0]=i,n[1]=e,n[2]=0,n[3]=-e,n[4]=i,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n};C.fromScaling=function(n,r){return n[0]=r[0],n[1]=0,n[2]=0,n[3]=0,n[4]=r[1],n[5]=0,n[6]=0,n[7]=0,n[8]=1,n};C.fromMat2d=function(n,r){return n[0]=r[0],n[1]=r[1],n[2]=0,n[3]=r[2],n[4]=r[3],n[5]=0,n[6]=r[4],n[7]=r[5],n[8]=1,n};C.fromQuat=function(n,r){var e=r[0],i=r[1],s=r[2],c=r[3],f=e+e,h=i+i,a=s+s,t=e*f,l=i*f,d=i*h,v=s*f,M=s*h,y=s*a,p=c*f,x=c*h,w=c*a;return n[0]=1-d-y,n[3]=l-w,n[6]=v+x,n[1]=l+w,n[4]=1-t-y,n[7]=M-p,n[2]=v-x,n[5]=M+p,n[8]=1-t-d,n};C.normalFromMat4=function(n,r){var e=r[0],i=r[1],s=r[2],c=r[3],f=r[4],h=r[5],a=r[6],t=r[7],l=r[8],d=r[9],v=r[10],M=r[11],y=r[12],p=r[13],x=r[14],w=r[15],R=e*h-i*f,g=e*a-s*f,_=e*t-c*f,z=i*a-s*h,m=i*t-c*h,I=s*t-c*a,Y=l*p-d*y,E=l*x-v*y,S=l*w-M*y,W=d*x-v*p,F=d*w-M*p,j=v*w-M*x,A=R*j-g*F+_*W+z*S-m*E+I*Y;return A?(A=1/A,n[0]=(h*j-a*F+t*W)*A,n[1]=(a*S-f*j-t*E)*A,n[2]=(f*F-h*S+t*Y)*A,n[3]=(s*F-i*j-c*W)*A,n[4]=(e*j-s*S+c*E)*A,n[5]=(i*S-e*F-c*Y)*A,n[6]=(p*I-x*m+w*z)*A,n[7]=(x*_-y*I-w*g)*A,n[8]=(y*m-p*_+w*R)*A,n):null};C.str=function(n){return"mat3("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+", "+n[6]+", "+n[7]+", "+n[8]+")"};C.frob=function(n){return Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2)+Math.pow(n[2],2)+Math.pow(n[3],2)+Math.pow(n[4],2)+Math.pow(n[5],2)+Math.pow(n[6],2)+Math.pow(n[7],2)+Math.pow(n[8],2))};var V1=C,a1=s1,N={};N.create=function(){var n=new a1.ARRAY_TYPE(16);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n};N.clone=function(n){var r=new a1.ARRAY_TYPE(16);return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15],r};N.copy=function(n,r){return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],n};N.identity=function(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n};N.transpose=function(n,r){if(n===r){var e=r[1],i=r[2],s=r[3],c=r[6],f=r[7],h=r[11];n[1]=r[4],n[2]=r[8],n[3]=r[12],n[4]=e,n[6]=r[9],n[7]=r[13],n[8]=i,n[9]=c,n[11]=r[14],n[12]=s,n[13]=f,n[14]=h}else n[0]=r[0],n[1]=r[4],n[2]=r[8],n[3]=r[12],n[4]=r[1],n[5]=r[5],n[6]=r[9],n[7]=r[13],n[8]=r[2],n[9]=r[6],n[10]=r[10],n[11]=r[14],n[12]=r[3],n[13]=r[7],n[14]=r[11],n[15]=r[15];return n};N.invert=function(n,r){var e=r[0],i=r[1],s=r[2],c=r[3],f=r[4],h=r[5],a=r[6],t=r[7],l=r[8],d=r[9],v=r[10],M=r[11],y=r[12],p=r[13],x=r[14],w=r[15],R=e*h-i*f,g=e*a-s*f,_=e*t-c*f,z=i*a-s*h,m=i*t-c*h,I=s*t-c*a,Y=l*p-d*y,E=l*x-v*y,S=l*w-M*y,W=d*x-v*p,F=d*w-M*p,j=v*w-M*x,A=R*j-g*F+_*W+z*S-m*E+I*Y;return A?(A=1/A,n[0]=(h*j-a*F+t*W)*A,n[1]=(s*F-i*j-c*W)*A,n[2]=(p*I-x*m+w*z)*A,n[3]=(v*m-d*I-M*z)*A,n[4]=(a*S-f*j-t*E)*A,n[5]=(e*j-s*S+c*E)*A,n[6]=(x*_-y*I-w*g)*A,n[7]=(l*I-v*_+M*g)*A,n[8]=(f*F-h*S+t*Y)*A,n[9]=(i*S-e*F-c*Y)*A,n[10]=(y*m-p*_+w*R)*A,n[11]=(d*_-l*m-M*R)*A,n[12]=(h*E-f*W-a*Y)*A,n[13]=(e*W-i*E+s*Y)*A,n[14]=(p*g-y*z-x*R)*A,n[15]=(l*z-d*g+v*R)*A,n):null};N.adjoint=function(n,r){var e=r[0],i=r[1],s=r[2],c=r[3],f=r[4],h=r[5],a=r[6],t=r[7],l=r[8],d=r[9],v=r[10],M=r[11],y=r[12],p=r[13],x=r[14],w=r[15];return n[0]=h*(v*w-M*x)-d*(a*w-t*x)+p*(a*M-t*v),n[1]=-(i*(v*w-M*x)-d*(s*w-c*x)+p*(s*M-c*v)),n[2]=i*(a*w-t*x)-h*(s*w-c*x)+p*(s*t-c*a),n[3]=-(i*(a*M-t*v)-h*(s*M-c*v)+d*(s*t-c*a)),n[4]=-(f*(v*w-M*x)-l*(a*w-t*x)+y*(a*M-t*v)),n[5]=e*(v*w-M*x)-l*(s*w-c*x)+y*(s*M-c*v),n[6]=-(e*(a*w-t*x)-f*(s*w-c*x)+y*(s*t-c*a)),n[7]=e*(a*M-t*v)-f*(s*M-c*v)+l*(s*t-c*a),n[8]=f*(d*w-M*p)-l*(h*w-t*p)+y*(h*M-t*d),n[9]=-(e*(d*w-M*p)-l*(i*w-c*p)+y*(i*M-c*d)),n[10]=e*(h*w-t*p)-f*(i*w-c*p)+y*(i*t-c*h),n[11]=-(e*(h*M-t*d)-f*(i*M-c*d)+l*(i*t-c*h)),n[12]=-(f*(d*x-v*p)-l*(h*x-a*p)+y*(h*v-a*d)),n[13]=e*(d*x-v*p)-l*(i*x-s*p)+y*(i*v-s*d),n[14]=-(e*(h*x-a*p)-f*(i*x-s*p)+y*(i*a-s*h)),n[15]=e*(h*v-a*d)-f*(i*v-s*d)+l*(i*a-s*h),n};N.determinant=function(n){var r=n[0],e=n[1],i=n[2],s=n[3],c=n[4],f=n[5],h=n[6],a=n[7],t=n[8],l=n[9],d=n[10],v=n[11],M=n[12],y=n[13],p=n[14],x=n[15],w=r*f-e*c,R=r*h-i*c,g=r*a-s*c,_=e*h-i*f,z=e*a-s*f,m=i*a-s*h,I=t*y-l*M,Y=t*p-d*M,E=t*x-v*M,S=l*p-d*y,W=l*x-v*y,F=d*x-v*p;return w*F-R*W+g*S+_*E-z*Y+m*I};N.multiply=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3],h=r[4],a=r[5],t=r[6],l=r[7],d=r[8],v=r[9],M=r[10],y=r[11],p=r[12],x=r[13],w=r[14],R=r[15],g=e[0],_=e[1],z=e[2],m=e[3];return n[0]=g*i+_*h+z*d+m*p,n[1]=g*s+_*a+z*v+m*x,n[2]=g*c+_*t+z*M+m*w,n[3]=g*f+_*l+z*y+m*R,g=e[4],_=e[5],z=e[6],m=e[7],n[4]=g*i+_*h+z*d+m*p,n[5]=g*s+_*a+z*v+m*x,n[6]=g*c+_*t+z*M+m*w,n[7]=g*f+_*l+z*y+m*R,g=e[8],_=e[9],z=e[10],m=e[11],n[8]=g*i+_*h+z*d+m*p,n[9]=g*s+_*a+z*v+m*x,n[10]=g*c+_*t+z*M+m*w,n[11]=g*f+_*l+z*y+m*R,g=e[12],_=e[13],z=e[14],m=e[15],n[12]=g*i+_*h+z*d+m*p,n[13]=g*s+_*a+z*v+m*x,n[14]=g*c+_*t+z*M+m*w,n[15]=g*f+_*l+z*y+m*R,n};N.mul=N.multiply;N.translate=function(n,r,e){var i=e[0],s=e[1],c=e[2],f,h,a,t,l,d,v,M,y,p,x,w;return r===n?(n[12]=r[0]*i+r[4]*s+r[8]*c+r[12],n[13]=r[1]*i+r[5]*s+r[9]*c+r[13],n[14]=r[2]*i+r[6]*s+r[10]*c+r[14],n[15]=r[3]*i+r[7]*s+r[11]*c+r[15]):(f=r[0],h=r[1],a=r[2],t=r[3],l=r[4],d=r[5],v=r[6],M=r[7],y=r[8],p=r[9],x=r[10],w=r[11],n[0]=f,n[1]=h,n[2]=a,n[3]=t,n[4]=l,n[5]=d,n[6]=v,n[7]=M,n[8]=y,n[9]=p,n[10]=x,n[11]=w,n[12]=f*i+l*s+y*c+r[12],n[13]=h*i+d*s+p*c+r[13],n[14]=a*i+v*s+x*c+r[14],n[15]=t*i+M*s+w*c+r[15]),n};N.scale=function(n,r,e){var i=e[0],s=e[1],c=e[2];return n[0]=r[0]*i,n[1]=r[1]*i,n[2]=r[2]*i,n[3]=r[3]*i,n[4]=r[4]*s,n[5]=r[5]*s,n[6]=r[6]*s,n[7]=r[7]*s,n[8]=r[8]*c,n[9]=r[9]*c,n[10]=r[10]*c,n[11]=r[11]*c,n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],n};N.rotate=function(n,r,e,i){var s=i[0],c=i[1],f=i[2],h=Math.sqrt(s*s+c*c+f*f),a,t,l,d,v,M,y,p,x,w,R,g,_,z,m,I,Y,E,S,W,F,j,A,J;return Math.abs(h)<a1.EPSILON?null:(h=1/h,s*=h,c*=h,f*=h,a=Math.sin(e),t=Math.cos(e),l=1-t,d=r[0],v=r[1],M=r[2],y=r[3],p=r[4],x=r[5],w=r[6],R=r[7],g=r[8],_=r[9],z=r[10],m=r[11],I=s*s*l+t,Y=c*s*l+f*a,E=f*s*l-c*a,S=s*c*l-f*a,W=c*c*l+t,F=f*c*l+s*a,j=s*f*l+c*a,A=c*f*l-s*a,J=f*f*l+t,n[0]=d*I+p*Y+g*E,n[1]=v*I+x*Y+_*E,n[2]=M*I+w*Y+z*E,n[3]=y*I+R*Y+m*E,n[4]=d*S+p*W+g*F,n[5]=v*S+x*W+_*F,n[6]=M*S+w*W+z*F,n[7]=y*S+R*W+m*F,n[8]=d*j+p*A+g*J,n[9]=v*j+x*A+_*J,n[10]=M*j+w*A+z*J,n[11]=y*j+R*A+m*J,r!==n&&(n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15]),n)};N.rotateX=function(n,r,e){var i=Math.sin(e),s=Math.cos(e),c=r[4],f=r[5],h=r[6],a=r[7],t=r[8],l=r[9],d=r[10],v=r[11];return r!==n&&(n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15]),n[4]=c*s+t*i,n[5]=f*s+l*i,n[6]=h*s+d*i,n[7]=a*s+v*i,n[8]=t*s-c*i,n[9]=l*s-f*i,n[10]=d*s-h*i,n[11]=v*s-a*i,n};N.rotateY=function(n,r,e){var i=Math.sin(e),s=Math.cos(e),c=r[0],f=r[1],h=r[2],a=r[3],t=r[8],l=r[9],d=r[10],v=r[11];return r!==n&&(n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15]),n[0]=c*s-t*i,n[1]=f*s-l*i,n[2]=h*s-d*i,n[3]=a*s-v*i,n[8]=c*i+t*s,n[9]=f*i+l*s,n[10]=h*i+d*s,n[11]=a*i+v*s,n};N.rotateZ=function(n,r,e){var i=Math.sin(e),s=Math.cos(e),c=r[0],f=r[1],h=r[2],a=r[3],t=r[4],l=r[5],d=r[6],v=r[7];return r!==n&&(n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15]),n[0]=c*s+t*i,n[1]=f*s+l*i,n[2]=h*s+d*i,n[3]=a*s+v*i,n[4]=t*s-c*i,n[5]=l*s-f*i,n[6]=d*s-h*i,n[7]=v*s-a*i,n};N.fromTranslation=function(n,r){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=r[0],n[13]=r[1],n[14]=r[2],n[15]=1,n};N.fromScaling=function(n,r){return n[0]=r[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=r[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=r[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n};N.fromRotation=function(n,r,e){var i=e[0],s=e[1],c=e[2],f=Math.sqrt(i*i+s*s+c*c),h,a,t;return Math.abs(f)<a1.EPSILON?null:(f=1/f,i*=f,s*=f,c*=f,h=Math.sin(r),a=Math.cos(r),t=1-a,n[0]=i*i*t+a,n[1]=s*i*t+c*h,n[2]=c*i*t-s*h,n[3]=0,n[4]=i*s*t-c*h,n[5]=s*s*t+a,n[6]=c*s*t+i*h,n[7]=0,n[8]=i*c*t+s*h,n[9]=s*c*t-i*h,n[10]=c*c*t+a,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n)};N.fromXRotation=function(n,r){var e=Math.sin(r),i=Math.cos(r);return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=i,n[6]=e,n[7]=0,n[8]=0,n[9]=-e,n[10]=i,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n};N.fromYRotation=function(n,r){var e=Math.sin(r),i=Math.cos(r);return n[0]=i,n[1]=0,n[2]=-e,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=e,n[9]=0,n[10]=i,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n};N.fromZRotation=function(n,r){var e=Math.sin(r),i=Math.cos(r);return n[0]=i,n[1]=e,n[2]=0,n[3]=0,n[4]=-e,n[5]=i,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n};N.fromRotationTranslation=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3],h=i+i,a=s+s,t=c+c,l=i*h,d=i*a,v=i*t,M=s*a,y=s*t,p=c*t,x=f*h,w=f*a,R=f*t;return n[0]=1-(M+p),n[1]=d+R,n[2]=v-w,n[3]=0,n[4]=d-R,n[5]=1-(l+p),n[6]=y+x,n[7]=0,n[8]=v+w,n[9]=y-x,n[10]=1-(l+M),n[11]=0,n[12]=e[0],n[13]=e[1],n[14]=e[2],n[15]=1,n};N.fromRotationTranslationScale=function(n,r,e,i){var s=r[0],c=r[1],f=r[2],h=r[3],a=s+s,t=c+c,l=f+f,d=s*a,v=s*t,M=s*l,y=c*t,p=c*l,x=f*l,w=h*a,R=h*t,g=h*l,_=i[0],z=i[1],m=i[2];return n[0]=(1-(y+x))*_,n[1]=(v+g)*_,n[2]=(M-R)*_,n[3]=0,n[4]=(v-g)*z,n[5]=(1-(d+x))*z,n[6]=(p+w)*z,n[7]=0,n[8]=(M+R)*m,n[9]=(p-w)*m,n[10]=(1-(d+y))*m,n[11]=0,n[12]=e[0],n[13]=e[1],n[14]=e[2],n[15]=1,n};N.fromRotationTranslationScaleOrigin=function(n,r,e,i,s){var c=r[0],f=r[1],h=r[2],a=r[3],t=c+c,l=f+f,d=h+h,v=c*t,M=c*l,y=c*d,p=f*l,x=f*d,w=h*d,R=a*t,g=a*l,_=a*d,z=i[0],m=i[1],I=i[2],Y=s[0],E=s[1],S=s[2];return n[0]=(1-(p+w))*z,n[1]=(M+_)*z,n[2]=(y-g)*z,n[3]=0,n[4]=(M-_)*m,n[5]=(1-(v+w))*m,n[6]=(x+R)*m,n[7]=0,n[8]=(y+g)*I,n[9]=(x-R)*I,n[10]=(1-(v+p))*I,n[11]=0,n[12]=e[0]+Y-(n[0]*Y+n[4]*E+n[8]*S),n[13]=e[1]+E-(n[1]*Y+n[5]*E+n[9]*S),n[14]=e[2]+S-(n[2]*Y+n[6]*E+n[10]*S),n[15]=1,n};N.fromQuat=function(n,r){var e=r[0],i=r[1],s=r[2],c=r[3],f=e+e,h=i+i,a=s+s,t=e*f,l=i*f,d=i*h,v=s*f,M=s*h,y=s*a,p=c*f,x=c*h,w=c*a;return n[0]=1-d-y,n[1]=l+w,n[2]=v-x,n[3]=0,n[4]=l-w,n[5]=1-t-y,n[6]=M+p,n[7]=0,n[8]=v+x,n[9]=M-p,n[10]=1-t-d,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n};N.frustum=function(n,r,e,i,s,c,f){var h=1/(e-r),a=1/(s-i),t=1/(c-f);return n[0]=c*2*h,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=c*2*a,n[6]=0,n[7]=0,n[8]=(e+r)*h,n[9]=(s+i)*a,n[10]=(f+c)*t,n[11]=-1,n[12]=0,n[13]=0,n[14]=f*c*2*t,n[15]=0,n};N.perspective=function(n,r,e,i,s){var c=1/Math.tan(r/2),f=1/(i-s);return n[0]=c/e,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=c,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=(s+i)*f,n[11]=-1,n[12]=0,n[13]=0,n[14]=2*s*i*f,n[15]=0,n};N.perspectiveFromFieldOfView=function(n,r,e,i){var s=Math.tan(r.upDegrees*Math.PI/180),c=Math.tan(r.downDegrees*Math.PI/180),f=Math.tan(r.leftDegrees*Math.PI/180),h=Math.tan(r.rightDegrees*Math.PI/180),a=2/(f+h),t=2/(s+c);return n[0]=a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=t,n[6]=0,n[7]=0,n[8]=-((f-h)*a*.5),n[9]=(s-c)*t*.5,n[10]=i/(e-i),n[11]=-1,n[12]=0,n[13]=0,n[14]=i*e/(e-i),n[15]=0,n};N.ortho=function(n,r,e,i,s,c,f){var h=1/(r-e),a=1/(i-s),t=1/(c-f);return n[0]=-2*h,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*a,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*t,n[11]=0,n[12]=(r+e)*h,n[13]=(s+i)*a,n[14]=(f+c)*t,n[15]=1,n};N.lookAt=function(n,r,e,i){var s,c,f,h,a,t,l,d,v,M,y=r[0],p=r[1],x=r[2],w=i[0],R=i[1],g=i[2],_=e[0],z=e[1],m=e[2];return Math.abs(y-_)<a1.EPSILON&&Math.abs(p-z)<a1.EPSILON&&Math.abs(x-m)<a1.EPSILON?N.identity(n):(l=y-_,d=p-z,v=x-m,M=1/Math.sqrt(l*l+d*d+v*v),l*=M,d*=M,v*=M,s=R*v-g*d,c=g*l-w*v,f=w*d-R*l,M=Math.sqrt(s*s+c*c+f*f),M?(M=1/M,s*=M,c*=M,f*=M):(s=0,c=0,f=0),h=d*f-v*c,a=v*s-l*f,t=l*c-d*s,M=Math.sqrt(h*h+a*a+t*t),M?(M=1/M,h*=M,a*=M,t*=M):(h=0,a=0,t=0),n[0]=s,n[1]=h,n[2]=l,n[3]=0,n[4]=c,n[5]=a,n[6]=d,n[7]=0,n[8]=f,n[9]=t,n[10]=v,n[11]=0,n[12]=-(s*y+c*p+f*x),n[13]=-(h*y+a*p+t*x),n[14]=-(l*y+d*p+v*x),n[15]=1,n)};N.str=function(n){return"mat4("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+", "+n[6]+", "+n[7]+", "+n[8]+", "+n[9]+", "+n[10]+", "+n[11]+", "+n[12]+", "+n[13]+", "+n[14]+", "+n[15]+")"};N.frob=function(n){return Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2)+Math.pow(n[2],2)+Math.pow(n[3],2)+Math.pow(n[4],2)+Math.pow(n[5],2)+Math.pow(n[6],2)+Math.pow(n[7],2)+Math.pow(n[8],2)+Math.pow(n[9],2)+Math.pow(n[10],2)+Math.pow(n[11],2)+Math.pow(n[12],2)+Math.pow(n[13],2)+Math.pow(n[14],2)+Math.pow(n[15],2))};var cn=N,x1=s1,T={};T.create=function(){var n=new x1.ARRAY_TYPE(3);return n[0]=0,n[1]=0,n[2]=0,n};T.clone=function(n){var r=new x1.ARRAY_TYPE(3);return r[0]=n[0],r[1]=n[1],r[2]=n[2],r};T.fromValues=function(n,r,e){var i=new x1.ARRAY_TYPE(3);return i[0]=n,i[1]=r,i[2]=e,i};T.copy=function(n,r){return n[0]=r[0],n[1]=r[1],n[2]=r[2],n};T.set=function(n,r,e,i){return n[0]=r,n[1]=e,n[2]=i,n};T.add=function(n,r,e){return n[0]=r[0]+e[0],n[1]=r[1]+e[1],n[2]=r[2]+e[2],n};T.subtract=function(n,r,e){return n[0]=r[0]-e[0],n[1]=r[1]-e[1],n[2]=r[2]-e[2],n};T.sub=T.subtract;T.multiply=function(n,r,e){return n[0]=r[0]*e[0],n[1]=r[1]*e[1],n[2]=r[2]*e[2],n};T.mul=T.multiply;T.divide=function(n,r,e){return n[0]=r[0]/e[0],n[1]=r[1]/e[1],n[2]=r[2]/e[2],n};T.div=T.divide;T.min=function(n,r,e){return n[0]=Math.min(r[0],e[0]),n[1]=Math.min(r[1],e[1]),n[2]=Math.min(r[2],e[2]),n};T.max=function(n,r,e){return n[0]=Math.max(r[0],e[0]),n[1]=Math.max(r[1],e[1]),n[2]=Math.max(r[2],e[2]),n};T.scale=function(n,r,e){return n[0]=r[0]*e,n[1]=r[1]*e,n[2]=r[2]*e,n};T.scaleAndAdd=function(n,r,e,i){return n[0]=r[0]+e[0]*i,n[1]=r[1]+e[1]*i,n[2]=r[2]+e[2]*i,n};T.distance=function(n,r){var e=r[0]-n[0],i=r[1]-n[1],s=r[2]-n[2];return Math.sqrt(e*e+i*i+s*s)};T.dist=T.distance;T.squaredDistance=function(n,r){var e=r[0]-n[0],i=r[1]-n[1],s=r[2]-n[2];return e*e+i*i+s*s};T.sqrDist=T.squaredDistance;T.length=function(n){var r=n[0],e=n[1],i=n[2];return Math.sqrt(r*r+e*e+i*i)};T.len=T.length;T.squaredLength=function(n){var r=n[0],e=n[1],i=n[2];return r*r+e*e+i*i};T.sqrLen=T.squaredLength;T.negate=function(n,r){return n[0]=-r[0],n[1]=-r[1],n[2]=-r[2],n};T.inverse=function(n,r){return n[0]=1/r[0],n[1]=1/r[1],n[2]=1/r[2],n};T.normalize=function(n,r){var e=r[0],i=r[1],s=r[2],c=e*e+i*i+s*s;return c>0&&(c=1/Math.sqrt(c),n[0]=r[0]*c,n[1]=r[1]*c,n[2]=r[2]*c),n};T.dot=function(n,r){return n[0]*r[0]+n[1]*r[1]+n[2]*r[2]};T.cross=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=e[0],h=e[1],a=e[2];return n[0]=s*a-c*h,n[1]=c*f-i*a,n[2]=i*h-s*f,n};T.lerp=function(n,r,e,i){var s=r[0],c=r[1],f=r[2];return n[0]=s+i*(e[0]-s),n[1]=c+i*(e[1]-c),n[2]=f+i*(e[2]-f),n};T.hermite=function(n,r,e,i,s,c){var f=c*c,h=f*(2*c-3)+1,a=f*(c-2)+c,t=f*(c-1),l=f*(3-2*c);return n[0]=r[0]*h+e[0]*a+i[0]*t+s[0]*l,n[1]=r[1]*h+e[1]*a+i[1]*t+s[1]*l,n[2]=r[2]*h+e[2]*a+i[2]*t+s[2]*l,n};T.bezier=function(n,r,e,i,s,c){var f=1-c,h=f*f,a=c*c,t=h*f,l=3*c*h,d=3*a*f,v=a*c;return n[0]=r[0]*t+e[0]*l+i[0]*d+s[0]*v,n[1]=r[1]*t+e[1]*l+i[1]*d+s[1]*v,n[2]=r[2]*t+e[2]*l+i[2]*d+s[2]*v,n};T.random=function(n,r){r=r||1;var e=x1.RANDOM()*2*Math.PI,i=x1.RANDOM()*2-1,s=Math.sqrt(1-i*i)*r;return n[0]=Math.cos(e)*s,n[1]=Math.sin(e)*s,n[2]=i*r,n};T.transformMat4=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=e[3]*i+e[7]*s+e[11]*c+e[15];return f=f||1,n[0]=(e[0]*i+e[4]*s+e[8]*c+e[12])/f,n[1]=(e[1]*i+e[5]*s+e[9]*c+e[13])/f,n[2]=(e[2]*i+e[6]*s+e[10]*c+e[14])/f,n};T.transformMat3=function(n,r,e){var i=r[0],s=r[1],c=r[2];return n[0]=i*e[0]+s*e[3]+c*e[6],n[1]=i*e[1]+s*e[4]+c*e[7],n[2]=i*e[2]+s*e[5]+c*e[8],n};T.transformQuat=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=e[0],h=e[1],a=e[2],t=e[3],l=t*i+h*c-a*s,d=t*s+a*i-f*c,v=t*c+f*s-h*i,M=-f*i-h*s-a*c;return n[0]=l*t+M*-f+d*-a-v*-h,n[1]=d*t+M*-h+v*-f-l*-a,n[2]=v*t+M*-a+l*-h-d*-f,n};T.rotateX=function(n,r,e,i){var s=[],c=[];return s[0]=r[0]-e[0],s[1]=r[1]-e[1],s[2]=r[2]-e[2],c[0]=s[0],c[1]=s[1]*Math.cos(i)-s[2]*Math.sin(i),c[2]=s[1]*Math.sin(i)+s[2]*Math.cos(i),n[0]=c[0]+e[0],n[1]=c[1]+e[1],n[2]=c[2]+e[2],n};T.rotateY=function(n,r,e,i){var s=[],c=[];return s[0]=r[0]-e[0],s[1]=r[1]-e[1],s[2]=r[2]-e[2],c[0]=s[2]*Math.sin(i)+s[0]*Math.cos(i),c[1]=s[1],c[2]=s[2]*Math.cos(i)-s[0]*Math.sin(i),n[0]=c[0]+e[0],n[1]=c[1]+e[1],n[2]=c[2]+e[2],n};T.rotateZ=function(n,r,e,i){var s=[],c=[];return s[0]=r[0]-e[0],s[1]=r[1]-e[1],s[2]=r[2]-e[2],c[0]=s[0]*Math.cos(i)-s[1]*Math.sin(i),c[1]=s[0]*Math.sin(i)+s[1]*Math.cos(i),c[2]=s[2],n[0]=c[0]+e[0],n[1]=c[1]+e[1],n[2]=c[2]+e[2],n};T.forEach=function(){var n=T.create();return function(r,e,i,s,c,f){var h,a;for(e||(e=3),i||(i=0),s?a=Math.min(s*e+i,r.length):a=r.length,h=i;h<a;h+=e)n[0]=r[h],n[1]=r[h+1],n[2]=r[h+2],c(n,n,f),r[h]=n[0],r[h+1]=n[1],r[h+2]=n[2];return r}}();T.angle=function(n,r){var e=T.fromValues(n[0],n[1],n[2]),i=T.fromValues(r[0],r[1],r[2]);T.normalize(e,e),T.normalize(i,i);var s=T.dot(e,i);return s>1?0:Math.acos(s)};T.str=function(n){return"vec3("+n[0]+", "+n[1]+", "+n[2]+")"};var F1=T,f1=s1,L={};L.create=function(){var n=new f1.ARRAY_TYPE(4);return n[0]=0,n[1]=0,n[2]=0,n[3]=0,n};L.clone=function(n){var r=new f1.ARRAY_TYPE(4);return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r};L.fromValues=function(n,r,e,i){var s=new f1.ARRAY_TYPE(4);return s[0]=n,s[1]=r,s[2]=e,s[3]=i,s};L.copy=function(n,r){return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n};L.set=function(n,r,e,i,s){return n[0]=r,n[1]=e,n[2]=i,n[3]=s,n};L.add=function(n,r,e){return n[0]=r[0]+e[0],n[1]=r[1]+e[1],n[2]=r[2]+e[2],n[3]=r[3]+e[3],n};L.subtract=function(n,r,e){return n[0]=r[0]-e[0],n[1]=r[1]-e[1],n[2]=r[2]-e[2],n[3]=r[3]-e[3],n};L.sub=L.subtract;L.multiply=function(n,r,e){return n[0]=r[0]*e[0],n[1]=r[1]*e[1],n[2]=r[2]*e[2],n[3]=r[3]*e[3],n};L.mul=L.multiply;L.divide=function(n,r,e){return n[0]=r[0]/e[0],n[1]=r[1]/e[1],n[2]=r[2]/e[2],n[3]=r[3]/e[3],n};L.div=L.divide;L.min=function(n,r,e){return n[0]=Math.min(r[0],e[0]),n[1]=Math.min(r[1],e[1]),n[2]=Math.min(r[2],e[2]),n[3]=Math.min(r[3],e[3]),n};L.max=function(n,r,e){return n[0]=Math.max(r[0],e[0]),n[1]=Math.max(r[1],e[1]),n[2]=Math.max(r[2],e[2]),n[3]=Math.max(r[3],e[3]),n};L.scale=function(n,r,e){return n[0]=r[0]*e,n[1]=r[1]*e,n[2]=r[2]*e,n[3]=r[3]*e,n};L.scaleAndAdd=function(n,r,e,i){return n[0]=r[0]+e[0]*i,n[1]=r[1]+e[1]*i,n[2]=r[2]+e[2]*i,n[3]=r[3]+e[3]*i,n};L.distance=function(n,r){var e=r[0]-n[0],i=r[1]-n[1],s=r[2]-n[2],c=r[3]-n[3];return Math.sqrt(e*e+i*i+s*s+c*c)};L.dist=L.distance;L.squaredDistance=function(n,r){var e=r[0]-n[0],i=r[1]-n[1],s=r[2]-n[2],c=r[3]-n[3];return e*e+i*i+s*s+c*c};L.sqrDist=L.squaredDistance;L.length=function(n){var r=n[0],e=n[1],i=n[2],s=n[3];return Math.sqrt(r*r+e*e+i*i+s*s)};L.len=L.length;L.squaredLength=function(n){var r=n[0],e=n[1],i=n[2],s=n[3];return r*r+e*e+i*i+s*s};L.sqrLen=L.squaredLength;L.negate=function(n,r){return n[0]=-r[0],n[1]=-r[1],n[2]=-r[2],n[3]=-r[3],n};L.inverse=function(n,r){return n[0]=1/r[0],n[1]=1/r[1],n[2]=1/r[2],n[3]=1/r[3],n};L.normalize=function(n,r){var e=r[0],i=r[1],s=r[2],c=r[3],f=e*e+i*i+s*s+c*c;return f>0&&(f=1/Math.sqrt(f),n[0]=e*f,n[1]=i*f,n[2]=s*f,n[3]=c*f),n};L.dot=function(n,r){return n[0]*r[0]+n[1]*r[1]+n[2]*r[2]+n[3]*r[3]};L.lerp=function(n,r,e,i){var s=r[0],c=r[1],f=r[2],h=r[3];return n[0]=s+i*(e[0]-s),n[1]=c+i*(e[1]-c),n[2]=f+i*(e[2]-f),n[3]=h+i*(e[3]-h),n};L.random=function(n,r){return r=r||1,n[0]=f1.RANDOM(),n[1]=f1.RANDOM(),n[2]=f1.RANDOM(),n[3]=f1.RANDOM(),L.normalize(n,n),L.scale(n,n,r),n};L.transformMat4=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3];return n[0]=e[0]*i+e[4]*s+e[8]*c+e[12]*f,n[1]=e[1]*i+e[5]*s+e[9]*c+e[13]*f,n[2]=e[2]*i+e[6]*s+e[10]*c+e[14]*f,n[3]=e[3]*i+e[7]*s+e[11]*c+e[15]*f,n};L.transformQuat=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=e[0],h=e[1],a=e[2],t=e[3],l=t*i+h*c-a*s,d=t*s+a*i-f*c,v=t*c+f*s-h*i,M=-f*i-h*s-a*c;return n[0]=l*t+M*-f+d*-a-v*-h,n[1]=d*t+M*-h+v*-f-l*-a,n[2]=v*t+M*-a+l*-h-d*-f,n[3]=r[3],n};L.forEach=function(){var n=L.create();return function(r,e,i,s,c,f){var h,a;for(e||(e=4),i||(i=0),s?a=Math.min(s*e+i,r.length):a=r.length,h=i;h<a;h+=e)n[0]=r[h],n[1]=r[h+1],n[2]=r[h+2],n[3]=r[h+3],c(n,n,f),r[h]=n[0],r[h+1]=n[1],r[h+2]=n[2],r[h+3]=n[3];return r}}();L.str=function(n){return"vec4("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+")"};var fn=L,hn=s1,an=V1,n1=F1,b=fn,$={};$.create=function(){var n=new hn.ARRAY_TYPE(4);return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n};$.rotationTo=function(){var n=n1.create(),r=n1.fromValues(1,0,0),e=n1.fromValues(0,1,0);return function(i,s,c){var f=n1.dot(s,c);return f<-.999999?(n1.cross(n,r,s),n1.length(n)<1e-6&&n1.cross(n,e,s),n1.normalize(n,n),$.setAxisAngle(i,n,Math.PI),i):f>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(n1.cross(n,s,c),i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=1+f,$.normalize(i,i))}}();$.setAxes=function(){var n=an.create();return function(r,e,i,s){return n[0]=i[0],n[3]=i[1],n[6]=i[2],n[1]=s[0],n[4]=s[1],n[7]=s[2],n[2]=-e[0],n[5]=-e[1],n[8]=-e[2],$.normalize(r,$.fromMat3(r,n))}}();$.clone=b.clone;$.fromValues=b.fromValues;$.copy=b.copy;$.set=b.set;$.identity=function(n){return n[0]=0,n[1]=0,n[2]=0,n[3]=1,n};$.setAxisAngle=function(n,r,e){e=e*.5;var i=Math.sin(e);return n[0]=i*r[0],n[1]=i*r[1],n[2]=i*r[2],n[3]=Math.cos(e),n};$.add=b.add;$.multiply=function(n,r,e){var i=r[0],s=r[1],c=r[2],f=r[3],h=e[0],a=e[1],t=e[2],l=e[3];return n[0]=i*l+f*h+s*t-c*a,n[1]=s*l+f*a+c*h-i*t,n[2]=c*l+f*t+i*a-s*h,n[3]=f*l-i*h-s*a-c*t,n};$.mul=$.multiply;$.scale=b.scale;$.rotateX=function(n,r,e){e*=.5;var i=r[0],s=r[1],c=r[2],f=r[3],h=Math.sin(e),a=Math.cos(e);return n[0]=i*a+f*h,n[1]=s*a+c*h,n[2]=c*a-s*h,n[3]=f*a-i*h,n};$.rotateY=function(n,r,e){e*=.5;var i=r[0],s=r[1],c=r[2],f=r[3],h=Math.sin(e),a=Math.cos(e);return n[0]=i*a-c*h,n[1]=s*a+f*h,n[2]=c*a+i*h,n[3]=f*a-s*h,n};$.rotateZ=function(n,r,e){e*=.5;var i=r[0],s=r[1],c=r[2],f=r[3],h=Math.sin(e),a=Math.cos(e);return n[0]=i*a+s*h,n[1]=s*a-i*h,n[2]=c*a+f*h,n[3]=f*a-c*h,n};$.calculateW=function(n,r){var e=r[0],i=r[1],s=r[2];return n[0]=e,n[1]=i,n[2]=s,n[3]=Math.sqrt(Math.abs(1-e*e-i*i-s*s)),n};$.dot=b.dot;$.lerp=b.lerp;$.slerp=function(n,r,e,i){var s=r[0],c=r[1],f=r[2],h=r[3],a=e[0],t=e[1],l=e[2],d=e[3],v,M,y,p,x;return M=s*a+c*t+f*l+h*d,M<0&&(M=-M,a=-a,t=-t,l=-l,d=-d),1-M>1e-6?(v=Math.acos(M),y=Math.sin(v),p=Math.sin((1-i)*v)/y,x=Math.sin(i*v)/y):(p=1-i,x=i),n[0]=p*s+x*a,n[1]=p*c+x*t,n[2]=p*f+x*l,n[3]=p*h+x*d,n};$.sqlerp=function(){var n=$.create(),r=$.create();return function(e,i,s,c,f,h){return $.slerp(n,i,f,h),$.slerp(r,s,c,h),$.slerp(e,n,r,2*h*(1-h)),e}}();$.invert=function(n,r){var e=r[0],i=r[1],s=r[2],c=r[3],f=e*e+i*i+s*s+c*c,h=f?1/f:0;return n[0]=-e*h,n[1]=-i*h,n[2]=-s*h,n[3]=c*h,n};$.conjugate=function(n,r){return n[0]=-r[0],n[1]=-r[1],n[2]=-r[2],n[3]=r[3],n};$.length=b.length;$.len=$.length;$.squaredLength=b.squaredLength;$.sqrLen=$.squaredLength;$.normalize=b.normalize;$.fromMat3=function(n,r){var e=r[0]+r[4]+r[8],i;if(e>0)i=Math.sqrt(e+1),n[3]=.5*i,i=.5/i,n[0]=(r[5]-r[7])*i,n[1]=(r[6]-r[2])*i,n[2]=(r[1]-r[3])*i;else{var s=0;r[4]>r[0]&&(s=1),r[8]>r[s*3+s]&&(s=2);var c=(s+1)%3,f=(s+2)%3;i=Math.sqrt(r[s*3+s]-r[c*3+c]-r[f*3+f]+1),n[s]=.5*i,i=.5/i,n[3]=(r[c*3+f]-r[f*3+c])*i,n[c]=(r[c*3+s]+r[s*3+c])*i,n[f]=(r[f*3+s]+r[s*3+f])*i}return n};$.str=function(n){return"quat("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+")"};var tn=$,g1=s1,O={};O.create=function(){var n=new g1.ARRAY_TYPE(2);return n[0]=0,n[1]=0,n};O.clone=function(n){var r=new g1.ARRAY_TYPE(2);return r[0]=n[0],r[1]=n[1],r};O.fromValues=function(n,r){var e=new g1.ARRAY_TYPE(2);return e[0]=n,e[1]=r,e};O.copy=function(n,r){return n[0]=r[0],n[1]=r[1],n};O.set=function(n,r,e){return n[0]=r,n[1]=e,n};O.add=function(n,r,e){return n[0]=r[0]+e[0],n[1]=r[1]+e[1],n};O.subtract=function(n,r,e){return n[0]=r[0]-e[0],n[1]=r[1]-e[1],n};O.sub=O.subtract;O.multiply=function(n,r,e){return n[0]=r[0]*e[0],n[1]=r[1]*e[1],n};O.mul=O.multiply;O.divide=function(n,r,e){return n[0]=r[0]/e[0],n[1]=r[1]/e[1],n};O.div=O.divide;O.min=function(n,r,e){return n[0]=Math.min(r[0],e[0]),n[1]=Math.min(r[1],e[1]),n};O.max=function(n,r,e){return n[0]=Math.max(r[0],e[0]),n[1]=Math.max(r[1],e[1]),n};O.scale=function(n,r,e){return n[0]=r[0]*e,n[1]=r[1]*e,n};O.scaleAndAdd=function(n,r,e,i){return n[0]=r[0]+e[0]*i,n[1]=r[1]+e[1]*i,n};O.distance=function(n,r){var e=r[0]-n[0],i=r[1]-n[1];return Math.sqrt(e*e+i*i)};O.dist=O.distance;O.squaredDistance=function(n,r){var e=r[0]-n[0],i=r[1]-n[1];return e*e+i*i};O.sqrDist=O.squaredDistance;O.length=function(n){var r=n[0],e=n[1];return Math.sqrt(r*r+e*e)};O.len=O.length;O.squaredLength=function(n){var r=n[0],e=n[1];return r*r+e*e};O.sqrLen=O.squaredLength;O.negate=function(n,r){return n[0]=-r[0],n[1]=-r[1],n};O.inverse=function(n,r){return n[0]=1/r[0],n[1]=1/r[1],n};O.normalize=function(n,r){var e=r[0],i=r[1],s=e*e+i*i;return s>0&&(s=1/Math.sqrt(s),n[0]=r[0]*s,n[1]=r[1]*s),n};O.dot=function(n,r){return n[0]*r[0]+n[1]*r[1]};O.cross=function(n,r,e){var i=r[0]*e[1]-r[1]*e[0];return n[0]=n[1]=0,n[2]=i,n};O.lerp=function(n,r,e,i){var s=r[0],c=r[1];return n[0]=s+i*(e[0]-s),n[1]=c+i*(e[1]-c),n};O.random=function(n,r){r=r||1;var e=g1.RANDOM()*2*Math.PI;return n[0]=Math.cos(e)*r,n[1]=Math.sin(e)*r,n};O.transformMat2=function(n,r,e){var i=r[0],s=r[1];return n[0]=e[0]*i+e[2]*s,n[1]=e[1]*i+e[3]*s,n};O.transformMat2d=function(n,r,e){var i=r[0],s=r[1];return n[0]=e[0]*i+e[2]*s+e[4],n[1]=e[1]*i+e[3]*s+e[5],n};O.transformMat3=function(n,r,e){var i=r[0],s=r[1];return n[0]=e[0]*i+e[3]*s+e[6],n[1]=e[1]*i+e[4]*s+e[7],n};O.transformMat4=function(n,r,e){var i=r[0],s=r[1];return n[0]=e[0]*i+e[4]*s+e[12],n[1]=e[1]*i+e[5]*s+e[13],n};O.forEach=function(){var n=O.create();return function(r,e,i,s,c,f){var h,a;for(e||(e=2),i||(i=0),s?a=Math.min(s*e+i,r.length):a=r.length,h=i;h<a;h+=e)n[0]=r[h],n[1]=r[h+1],c(n,n,f),r[h]=n[0],r[h+1]=n[1];return r}}();O.str=function(n){return"vec2("+n[0]+", "+n[1]+")"};var B1=V1,t1=cn,l1=tn,e1=F1;const u=B1.create();function ln(n,r,e,i){r[0]=n[12],r[1]=n[13],r[2]=n[14],i[0]=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]),i[1]=Math.sqrt(n[4]*n[4]+n[5]*n[5]+n[6]*n[6]),i[2]=Math.sqrt(n[8]*n[8]+n[9]*n[9]+n[10]*n[10]),u[0]=n[0]/i[0],u[1]=n[1]/i[0],u[2]=n[2]/i[0],u[3]=n[4]/i[1],u[4]=n[5]/i[1],u[5]=n[6]/i[1],u[6]=n[8]/i[2],u[7]=n[9]/i[2],u[8]=n[10]/i[2],l1.fromMat3(e,u)}const m1=B1.create(),p1=new Float32Array(m1.buffer,0*4,3),vn=new Float32Array(m1.buffer,3*4,3),d1=new Float32Array(m1.buffer,6*4,3),Mn=e1.fromValues(0,1,0);class dn{constructor(){this.position=e1.create(),this.rotation=l1.create(),this.scale=e1.fromValues(1,1,1),this._matrix=t1.create(),this._wmatrix=t1.create(),this._parent=null,this._children=[],this._invalidM=!0,this._invalidW=!0,this._wposition=new Float32Array(this._wmatrix.buffer,12*4,3)}rotateX(r){l1.rotateX(this.rotation,this.rotation,r),this.invalidate()}rotateY(r){l1.rotateY(this.rotation,this.rotation,r),this.invalidate()}rotateZ(r){l1.rotateZ(this.rotation,this.rotation,r),this.invalidate()}set x(r){this.position[0]=r,this.invalidate()}set y(r){this.position[1]=r,this.invalidate()}set z(r){this.position[2]=r,this.invalidate()}get x(){return this.position[0]}get y(){return this.position[1]}get z(){return this.position[2]}setScale(r){this.scale[0]=this.scale[1]=this.scale[2]=r,this.invalidate()}lookAt(r){e1.subtract(d1,this.position,r),e1.normalize(d1,d1),e1.cross(p1,Mn,d1),e1.normalize(p1,p1),e1.cross(vn,d1,p1),l1.fromMat3(this.rotation,m1),this.invalidate()}setMatrix(r){t1.copy(this._matrix,r),ln(r,this.position,this.rotation,this.scale),this._invalidM=!1,this._invalidW=!0}add(r){this._children.indexOf(r)===-1&&(r._parent!==null&&r._parent.remove(r),this._children.push(r),r._parent=this)}remove(r){const e=this._children.indexOf(r);e>-1&&(this._children.splice(e,1),r._parent=null)}invalidate(){this._invalidM=!0,this._invalidW=!0}updateMatrix(){this._invalidM&&(t1.fromRotationTranslationScale(this._matrix,this.rotation,this.position,this.scale),this._invalidM=!1)}updateWorldMatrix(r=!1){this.updateMatrix();const e=this._hasInvalidWorldMatrix(r);e&&this._computeWorldMatrix(r);for(var i=0;i<this._children.length;i++){var s=this._children[i];s._invalidW=s._invalidW||e,s.updateWorldMatrix(!0)}}_computeWorldMatrix(r){const e=this._parent;e!==null?(!r&&e._hasInvalidWorldMatrix(!1)&&(e.updateMatrix(),e._computeWorldMatrix(!1)),t1.multiply(this._wmatrix,e._wmatrix,this._matrix)):t1.copy(this._wmatrix,this._matrix),this._invalidW=!1}_hasInvalidWorldMatrix(r){return this._invalidW||!r&&this._parent!==null&&this._parent._hasInvalidWorldMatrix(!1)}}class yn{constructor(){this._near=.01,this._far=10,this._fov=Math.PI/3,this._vfov=0,this._hfov=0,this._aspect=1,this._fovMode=0,this._proj=K.create(),this._valid=!1}getProjection(){return this._valid||this._updateProjection(),this._proj}set fov(r){this.setVerticalFov(r)}get fov(){return this._fov}set near(r){this._near!==r&&(this._near=r,this._invalidate())}get near(){return this._near}set far(r){this._far!==r&&(this._far=r,this._invalidate())}get far(){return this._far}set aspect(r){this._aspect!==r&&(this._aspect=r,this._invalidate())}get aspect(){return this._aspect}setHorizontalFov(r){this._fov=r,this._fovMode=2,this._invalidate()}setVerticalFov(r){this._fov=r,this._fovMode=1,this._invalidate()}getHorizontalFov(){return this.getProjection(),this._hfov}getVerticalFov(){return this.getProjection(),this._vfov}setAutoFov(r){this._fov=r,this._fovMode=3,this._invalidate()}_updateProjection(){var r=this._fovMode,e=this._aspect;r===1||r===3&&e>1?(this._vfov=this._fov,this._hfov=Math.atan(Math.tan(this._fov/2)*e)*2):(this._hfov=this._fov,this._vfov=Math.atan(Math.tan(this._fov/2)/e)*2),K.perspective(this._proj,this._vfov,e,this._near,this._far),this._valid=!0}_invalidate(){this._valid=!1}}class xn{constructor(){this._near=.01,this._far=10,this._xMin=-1,this._xMax=1,this._yMin=-1,this._yMax=1,this._aspect=1,this._proj=K.create(),this._valid=!1}getProjection(){return this._valid||this._updateProjection(),this._proj}setBound(r,e,i,s){this._xMin=r,this._xMax=e,this._yMin=i,this._yMax=s,this._invalidate()}set near(r){this._near!==r&&(this._near=r,this._invalidate())}get near(){return this._near}set far(r){this._far!==r&&(this._far=r,this._invalidate())}get far(){return this._far}set aspect(r){this._aspect!==r&&(this._aspect=r)}get aspect(){return this._aspect}_updateProjection(){K.ortho(this._proj,this._xMin,this._xMax,this._yMin,this._yMax,this._near,this._far),this._valid=!0}_invalidate(){this._valid=!1}}const T1=K.create(),S1=K.create();class R1 extends dn{constructor(r){super(),this.lens=r,this._view=K.create(),this._viewProj=K.create()}modelViewMatrix(r,e){K.multiply(r,e,this._view)}modelViewProjectionMatrix(r,e){K.multiply(r,this._viewProj,e)}getMVP(r){return K.multiply(T1,this._viewProj,r),T1}unproject(r,e){K.invert(S1,this._viewProj),en.transformMat4(r,e,S1)}updateViewProjectionMatrix(r,e){this.lens.aspect=r/e,K.multiply(this._viewProj,this.lens.getProjection(),this._view)}_computeWorldMatrix(r){super._computeWorldMatrix(r),K.invert(this._view,this._wmatrix)}static makePerspectiveCamera(){return new R1(new yn)}static makeOrthoCamera(){return new R1(new xn)}}class pn{drawPoints(r,e){this.draw(0,r,e)}drawLines(r,e){this.draw(1,r,e)}drawLineLoop(r,e){this.draw(2,r,e)}drawLineStrip(r,e){this.draw(3,r,e)}drawTriangles(r,e){this.draw(4,r,e)}drawTriangleStrip(r,e){this.draw(5,r,e)}drawTriangleFan(r,e){this.draw(6,r,e)}}function wn(n){return n.byteLength!==void 0}function _n(n){switch(n){case 5120:case 5121:return 1;case 5122:case 5123:return 2;case 5124:case 5125:case 5126:return 4;default:throw new Error(`unknown type ${n}`)}}const r1=34962;class gn extends pn{constructor(r,e,i=r.STATIC_DRAW,s){super(),this.gl=r,this.usage=i,this.buffer=s!==void 0?s:r.createBuffer(),this.attribs=[],this.stride=0,this.byteLength=0,this.length=0,e&&this.data(e)}bind(){this.gl.bindBuffer(r1,this.buffer)}attrib(r,e,i,s=!1){return this.attribs.push({name:r,type:0|i,size:0|e,normalize:s,offset:this.stride,stride:0}),this.stride+=_n(i)*e,this._computeLength(),this}data(r){const e=this.gl;e.bindBuffer(r1,this.buffer),e.bufferData(r1,r,this.usage),e.bindBuffer(r1,null),this.byteLength=wn(r)?r.byteLength:r,this._computeLength()}subData(r,e){const i=this.gl;i.bindBuffer(r1,this.buffer),i.bufferSubData(r1,e,r),i.bindBuffer(r1,null)}attribPointer(r){const e=this.gl;e.bindBuffer(r1,this.buffer);for(var i=0;i<this.attribs.length;i++){var s=this.attribs[i];if(r[s.name]!==void 0){var c=r[s.name]();e.enableVertexAttribArray(c),e.vertexAttribPointer(c,s.size,s.type,s.normalize,s.stride||this.stride,s.offset)}}}draw(r,e=this.length,i=0){this.gl.drawArrays(r,i,0|e)}dispose(){this.gl.deleteBuffer(this.buffer)}_computeLength(){this.stride>0&&(this.length=this.byteLength/this.stride)}}export{gn as A,R1 as C,dn as N,yn as P,w1 as a};
